(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const F of u.addedNodes)F.tagName==="LINK"&&F.rel==="modulepreload"&&a(F)}).observe(document,{childList:!0,subtree:!0});function n(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(i){if(i.ep)return;i.ep=!0;const u=n(i);fetch(i.href,u)}})();const We=!1;var Je=Array.isArray,gr=Array.prototype.indexOf,Sr=Array.from,Ur=Object.defineProperty,Ot=Object.getOwnPropertyDescriptor,Dr=Object.getOwnPropertyDescriptors,Ir=Object.prototype,Pr=Array.prototype,tr=Object.getPrototypeOf,Xe=Object.isExtensible;function Or(t){return t()}function we(t){for(var r=0;r<t.length;r++)t[r]()}const it=2,er=4,Fe=8,rr=16,dt=32,Dt=64,Gt=128,tt=256,$t=512,et=1024,pt=2048,Et=4096,Kt=8192,ee=16384,Lr=32768,Mr=65536,Br=1<<19,nr=1<<20,xe=1<<21,St=Symbol("$state");function ar(t){return t===this.v}function Nr(t,r){return t!=t?r==r:t!==r||t!==null&&typeof t=="object"||typeof t=="function"}function Cr(t){return!Nr(t,this.v)}function Hr(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function kr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Wr(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Xr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Vr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function zr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let re=!1,qr=!1;function Yr(){re=!0}const Gr=2,Y=Symbol();let H=null;function Ve(t){H=t}function or(t,r=!1,n){var a=H={p:H,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};re&&!r&&(H.l={s:null,u:null,r1:[],r2:Ae(!1)}),an(()=>{a.d=!0})}function ir(t){const r=H;if(r!==null){const F=r.e;if(F!==null){var n=N,a=M;r.e=null;try{for(var i=0;i<F.length;i++){var u=F[i];Ut(u.effect),vt(u.reaction),Ee(u.fn)}}finally{Ut(n),vt(a)}}H=r.p,r.m=!0}return{}}function ne(){return!re||H!==null&&H.l===null}function gt(t,r){if(typeof t!="object"||t===null||St in t)return t;const n=tr(t);if(n!==Ir&&n!==Pr)return t;var a=new Map,i=Je(t),u=_t(0),F=M,A=h=>{var f=M;vt(F);var d;return d=h(),vt(f),d};return i&&a.set("length",_t(t.length)),new Proxy(t,{defineProperty(h,f,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Vr();var p=a.get(f);return p===void 0?(p=A(()=>_t(d.value)),a.set(f,p)):O(p,A(()=>gt(d.value))),!0},deleteProperty(h,f){var d=a.get(f);if(d===void 0)f in h&&a.set(f,A(()=>_t(Y)));else{if(i&&typeof f=="string"){var p=a.get("length"),_=Number(f);Number.isInteger(_)&&_<p.v&&O(p,_)}O(d,Y),je(u)}return!0},get(h,f,d){var C;if(f===St)return t;var p=a.get(f),_=f in h;if(p===void 0&&(!_||(C=Ot(h,f))!=null&&C.writable)&&(p=A(()=>_t(gt(_?h[f]:Y))),a.set(f,p)),p!==void 0){var P=o(p);return P===Y?void 0:P}return Reflect.get(h,f,d)},getOwnPropertyDescriptor(h,f){var d=Reflect.getOwnPropertyDescriptor(h,f);if(d&&"value"in d){var p=a.get(f);p&&(d.value=o(p))}else if(d===void 0){var _=a.get(f),P=_==null?void 0:_.v;if(_!==void 0&&P!==Y)return{enumerable:!0,configurable:!0,value:P,writable:!0}}return d},has(h,f){var P;if(f===St)return!0;var d=a.get(f),p=d!==void 0&&d.v!==Y||Reflect.has(h,f);if(d!==void 0||N!==null&&(!p||(P=Ot(h,f))!=null&&P.writable)){d===void 0&&(d=A(()=>_t(p?gt(h[f]):Y)),a.set(f,d));var _=o(d);if(_===Y)return!1}return p},set(h,f,d,p){var nt;var _=a.get(f),P=f in h;if(i&&f==="length")for(var C=d;C<_.v;C+=1){var X=a.get(C+"");X!==void 0?O(X,Y):C in h&&(X=A(()=>_t(Y)),a.set(C+"",X))}_===void 0?(!P||(nt=Ot(h,f))!=null&&nt.writable)&&(_=A(()=>_t(void 0)),O(_,A(()=>gt(d))),a.set(f,_)):(P=_.v!==Y,O(_,A(()=>gt(d))));var j=Reflect.getOwnPropertyDescriptor(h,f);if(j!=null&&j.set&&j.set.call(p,d),!P){if(i&&typeof f=="string"){var wt=a.get("length"),st=Number(f);Number.isInteger(st)&&st>=wt.v&&O(wt,st+1)}je(u)}return!0},ownKeys(h){o(u);var f=Reflect.ownKeys(h).filter(_=>{var P=a.get(_);return P===void 0||P.v!==Y});for(var[d,p]of a)p.v!==Y&&!(d in h)&&f.push(d);return f},setPrototypeOf(){jr()}})}function je(t,r=1){O(t,t.v+r)}const Lt=new Map;function Ae(t,r){var n={f:0,v:t,reactions:null,equals:ar,rv:0,wv:0};return n}function _t(t,r){const n=Ae(t);return wn(n),n}function B(t,r=!1){var a;const n=Ae(t);return r||(n.equals=Cr),re&&H!==null&&H.l!==null&&((a=H.l).s??(a.s=[])).push(n),n}function ze(t,r){return O(t,ue(()=>o(t))),r}function O(t,r,n=!1){M!==null&&!ot&&ne()&&(M.f&(it|rr))!==0&&!(q!=null&&q.includes(t))&&zr();let a=n?gt(r):r;return $r(t,a)}function $r(t,r){if(!t.equals(r)){var n=t.v;Bt?Lt.set(t,r):Lt.set(t,n),t.v=r,t.wv=yr(),ur(t,pt),ne()&&N!==null&&(N.f&et)!==0&&(N.f&(dt|Dt))===0&&(J===null?xn([t]):J.push(t))}return r}function ur(t,r){var n=t.reactions;if(n!==null)for(var a=ne(),i=n.length,u=0;u<i;u++){var F=n[u],A=F.f;(A&pt)===0&&(!a&&F===N||(ut(F,r),(A&(et|tt))!==0&&((A&it)!==0?ur(F,Et):be(F))))}}var qe,sr,fr,lr;function Kr(){if(qe===void 0){qe=window,sr=/Firefox/.test(navigator.userAgent);var t=Element.prototype,r=Node.prototype,n=Text.prototype;fr=Ot(r,"firstChild").get,lr=Ot(r,"nextSibling").get,Xe(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Xe(n)&&(n.__t=void 0)}}function Qr(t=""){return document.createTextNode(t)}function cr(t){return fr.call(t)}function Zr(t){return lr.call(t)}function Jr(t,r){return cr(t)}function tn(t){var r=it|pt,n=M!==null&&(M.f&it)!==0?M:null;return N===null||n!==null&&(n.f&tt)!==0?r|=tt:N.f|=nr,{ctx:H,deps:null,effects:null,equals:ar,f:r,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??N}}function _r(t){var r=t.effects;if(r!==null){t.effects=null;for(var n=0;n<r.length;n+=1)At(r[n])}}function en(t){for(var r=t.parent;r!==null;){if((r.f&it)===0)return r;r=r.parent}return null}function rn(t){var r,n=N;Ut(en(t));try{_r(t),r=Ar(t)}finally{Ut(n)}return r}function hr(t){var r=rn(t),n=(ht||(t.f&tt)!==0)&&t.deps!==null?Et:et;ut(t,n),t.equals(r)||(t.v=r,t.wv=yr())}function vr(t){N===null&&M===null&&Wr(),M!==null&&(M.f&tt)!==0&&N===null&&kr(),Bt&&Hr()}function nn(t,r){var n=r.last;n===null?r.last=r.first=t:(n.next=t,t.prev=n,r.last=t)}function Mt(t,r,n,a=!0){var i=N,u={ctx:H,deps:null,nodes_start:null,nodes_end:null,f:t|pt,first:null,fn:r,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0};if(n)try{ie(u),u.f|=Lr}catch(h){throw At(u),h}else r!==null&&be(u);var F=n&&u.deps===null&&u.first===null&&u.nodes_start===null&&u.teardown===null&&(u.f&(nr|Gt))===0;if(!F&&a&&(i!==null&&nn(u,i),M!==null&&(M.f&it)!==0)){var A=M;(A.effects??(A.effects=[])).push(u)}return u}function an(t){const r=Mt(Fe,null,!1);return ut(r,et),r.teardown=t,r}function Ye(t){vr();var r=N!==null&&(N.f&dt)!==0&&H!==null&&!H.m;if(r){var n=H;(n.e??(n.e=[])).push({fn:t,effect:N,reaction:M})}else{var a=Ee(t);return a}}function on(t){return vr(),ae(t)}function un(t){const r=Mt(Dt,t,!0);return(n={})=>new Promise(a=>{n.outro?_n(r,()=>{At(r),a(void 0)}):(At(r),a(void 0))})}function Ee(t){return Mt(er,t,!1)}function sn(t,r){var n=H,a={effect:null,ran:!1};n.l.r1.push(a),a.effect=ae(()=>{t(),!a.ran&&(a.ran=!0,O(n.l.r2,!0),ue(r))})}function fn(){var t=H;ae(()=>{if(o(t.l.r2)){for(var r of t.l.r1){var n=r.effect;(n.f&et)!==0&&ut(n,Et),Nt(n)&&ie(n),r.ran=!1}t.l.r2.v=!1}})}function ae(t){return Mt(Fe,t,!0)}function ln(t,r=!0){return Mt(Fe|dt,t,!0,r)}function dr(t){var r=t.teardown;if(r!==null){const n=Bt,a=M;Ge(!0),vt(null);try{r.call(null)}finally{Ge(n),vt(a)}}}function pr(t,r=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var a=n.next;(n.f&Dt)!==0?n.parent=null:At(n,r),n=a}}function cn(t){for(var r=t.first;r!==null;){var n=r.next;(r.f&dt)===0&&At(r),r=n}}function At(t,r=!0){var n=!1;if((r||(t.f&Br)!==0)&&t.nodes_start!==null){for(var a=t.nodes_start,i=t.nodes_end;a!==null;){var u=a===i?null:Zr(a);a.remove(),a=u}n=!0}pr(t,r&&!n),te(t,0),ut(t,ee);var F=t.transitions;if(F!==null)for(const h of F)h.stop();dr(t);var A=t.parent;A!==null&&A.first!==null&&wr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function wr(t){var r=t.parent,n=t.prev,a=t.next;n!==null&&(n.next=a),a!==null&&(a.prev=n),r!==null&&(r.first===t&&(r.first=a),r.last===t&&(r.last=n))}function _n(t,r){var n=[];xr(t,n,!0),hn(n,()=>{At(t),r&&r()})}function hn(t,r){var n=t.length;if(n>0){var a=()=>--n||r();for(var i of t)i.out(a)}else r()}function xr(t,r,n){if((t.f&Kt)===0){if(t.f^=Kt,t.transitions!==null)for(const F of t.transitions)(F.is_global||n)&&r.push(F);for(var a=t.first;a!==null;){var i=a.next,u=(a.f&Mr)!==0||(a.f&dt)!==0;xr(a,r,u?n:!1),a=i}}}let Qt=[];function vn(){var t=Qt;Qt=[],we(t)}function dn(t){Qt.length===0&&queueMicrotask(vn),Qt.push(t)}let qt=!1,me=!1,Zt=null,Ft=!1,Bt=!1;function Ge(t){Bt=t}let Yt=[];let M=null,ot=!1;function vt(t){M=t}let N=null;function Ut(t){N=t}let q=null;function pn(t){q=t}function wn(t){M!==null&&M.f&xe&&(q===null?pn([t]):q.push(t))}let z=null,G=0,J=null;function xn(t){J=t}let mr=1,Jt=0,ht=!1;function yr(){return++mr}function Nt(t){var p;var r=t.f;if((r&pt)!==0)return!0;if((r&Et)!==0){var n=t.deps,a=(r&tt)!==0;if(n!==null){var i,u,F=(r&$t)!==0,A=a&&N!==null&&!ht,h=n.length;if(F||A){var f=t,d=f.parent;for(i=0;i<h;i++)u=n[i],(F||!((p=u==null?void 0:u.reactions)!=null&&p.includes(f)))&&(u.reactions??(u.reactions=[])).push(f);F&&(f.f^=$t),A&&d!==null&&(d.f&tt)===0&&(f.f^=tt)}for(i=0;i<h;i++)if(u=n[i],Nt(u)&&hr(u),u.wv>t.wv)return!0}(!a||N!==null&&!ht)&&ut(t,et)}return!1}function mn(t,r){for(var n=r;n!==null;){if((n.f&Gt)!==0)try{n.fn(t);return}catch{n.f^=Gt}n=n.parent}throw qt=!1,t}function yn(t){return(t.f&ee)===0&&(t.parent===null||(t.parent.f&Gt)===0)}function oe(t,r,n,a){if(qt){if(n===null&&(qt=!1),yn(r))throw t;return}n!==null&&(qt=!0);{mn(t,r);return}}function Fr(t,r,n=!0){var a=t.reactions;if(a!==null)for(var i=0;i<a.length;i++){var u=a[i];q!=null&&q.includes(t)||((u.f&it)!==0?Fr(u,r,!1):r===u&&(n?ut(u,pt):(u.f&et)!==0&&ut(u,Et),be(u)))}}function Ar(t){var P;var r=z,n=G,a=J,i=M,u=ht,F=q,A=H,h=ot,f=t.f;z=null,G=0,J=null,ht=(f&tt)!==0&&(ot||!Ft||M===null),M=(f&(dt|Dt))===0?t:null,q=null,Ve(t.ctx),ot=!1,Jt++,t.f|=xe;try{var d=(0,t.fn)(),p=t.deps;if(z!==null){var _;if(te(t,G),p!==null&&G>0)for(p.length=G+z.length,_=0;_<z.length;_++)p[G+_]=z[_];else t.deps=p=z;if(!ht)for(_=G;_<p.length;_++)((P=p[_]).reactions??(P.reactions=[])).push(t)}else p!==null&&G<p.length&&(te(t,G),p.length=G);if(ne()&&J!==null&&!ot&&p!==null&&(t.f&(it|Et|pt))===0)for(_=0;_<J.length;_++)Fr(J[_],t);return i!==null&&(Jt++,J!==null&&(a===null?a=J:a.push(...J))),d}finally{z=r,G=n,J=a,M=i,ht=u,q=F,Ve(A),ot=h,t.f^=xe}}function Fn(t,r){let n=r.reactions;if(n!==null){var a=gr.call(n,t);if(a!==-1){var i=n.length-1;i===0?n=r.reactions=null:(n[a]=n[i],n.pop())}}n===null&&(r.f&it)!==0&&(z===null||!z.includes(r))&&(ut(r,Et),(r.f&(tt|$t))===0&&(r.f^=$t),_r(r),te(r,0))}function te(t,r){var n=t.deps;if(n!==null)for(var a=r;a<n.length;a++)Fn(t,n[a])}function ie(t){var r=t.f;if((r&ee)===0){ut(t,et);var n=N,a=H,i=Ft;N=t,Ft=!0;try{(r&rr)!==0?cn(t):pr(t),dr(t);var u=Ar(t);t.teardown=typeof u=="function"?u:null,t.wv=mr;var F=t.deps,A;We&&qr&&t.f&pt}catch(h){oe(h,t,n,a||t.ctx)}finally{Ft=i,N=n}}}function An(){try{Xr()}catch(t){if(Zt!==null)oe(t,Zt,null);else throw t}}function En(){var t=Ft;try{var r=0;for(Ft=!0;Yt.length>0;){r++>1e3&&An();var n=Yt,a=n.length;Yt=[];for(var i=0;i<a;i++){var u=Tn(n[i]);bn(u)}}}finally{me=!1,Ft=t,Zt=null,Lt.clear()}}function bn(t){var r=t.length;if(r!==0)for(var n=0;n<r;n++){var a=t[n];if((a.f&(ee|Kt))===0)try{Nt(a)&&(ie(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?wr(a):a.fn=null))}catch(i){oe(i,a,null,a.ctx)}}}function be(t){me||(me=!0,queueMicrotask(En));for(var r=Zt=t;r.parent!==null;){r=r.parent;var n=r.f;if((n&(Dt|dt))!==0){if((n&et)===0)return;r.f^=et}}Yt.push(r)}function Tn(t){for(var r=[],n=t;n!==null;){var a=n.f,i=(a&(dt|Dt))!==0,u=i&&(a&et)!==0;if(!u&&(a&Kt)===0){if((a&er)!==0)r.push(n);else if(i)n.f^=et;else{var F=M;try{M=n,Nt(n)&&ie(n)}catch(f){oe(f,n,null,n.ctx)}finally{M=F}}var A=n.first;if(A!==null){n=A;continue}}var h=n.parent;for(n=n.next;n===null&&h!==null;)n=h.next,h=h.parent}return r}function o(t){var r=t.f,n=(r&it)!==0;if(M!==null&&!ot){if(!(q!=null&&q.includes(t))){var a=M.deps;t.rv<Jt&&(t.rv=Jt,z===null&&a!==null&&a[G]===t?G++:z===null?z=[t]:(!ht||!z.includes(t))&&z.push(t))}}else if(n&&t.deps===null&&t.effects===null){var i=t,u=i.parent;u!==null&&(u.f&tt)===0&&(i.f^=tt)}return n&&(i=t,Nt(i)&&hr(i)),Bt&&Lt.has(t)?Lt.get(t):t.v}function ue(t){var r=ot;try{return ot=!0,t()}finally{ot=r}}const Rn=-7169;function ut(t,r){t.f=t.f&Rn|r}function gn(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(St in t)ye(t);else if(!Array.isArray(t))for(let r in t){const n=t[r];typeof n=="object"&&n&&St in n&&ye(n)}}}function ye(t,r=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!r.has(t)){r.add(t),t instanceof Date&&t.getTime();for(let a in t)try{ye(t[a],r)}catch{}const n=tr(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const a=Dr(n);for(let i in a){const u=a[i].get;if(u)try{u.call(t)}catch{}}}}}const Sn=["touchstart","touchmove"];function Un(t){return Sn.includes(t)}const Dn=new Set,$e=new Set;function jt(t){var st;var r=this,n=r.ownerDocument,a=t.type,i=((st=t.composedPath)==null?void 0:st.call(t))||[],u=i[0]||t.target,F=0,A=t.__root;if(A){var h=i.indexOf(A);if(h!==-1&&(r===document||r===window)){t.__root=r;return}var f=i.indexOf(r);if(f===-1)return;h<=f&&(F=h)}if(u=i[F]||t.target,u!==r){Ur(t,"currentTarget",{configurable:!0,get(){return u||n}});var d=M,p=N;vt(null),Ut(null);try{for(var _,P=[];u!==null;){var C=u.assignedSlot||u.parentNode||u.host||null;try{var X=u["__"+a];if(X!=null&&(!u.disabled||t.target===u))if(Je(X)){var[j,...wt]=X;j.apply(u,[t,...wt])}else X.call(u,t)}catch(nt){_?P.push(nt):_=nt}if(t.cancelBubble||C===r||C===null)break;u=C}if(_){for(let nt of P)queueMicrotask(()=>{throw nt});throw _}}finally{t.__root=r,delete t.currentTarget,vt(d),Ut(p)}}}function In(t){var r=document.createElement("template");return r.innerHTML=t,r.content}function Pn(t,r){var n=N;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=r)}function On(t,r){var n=(r&Gr)!==0,a,i=!t.startsWith("<!>");return()=>{a===void 0&&(a=In(i?t:"<!>"+t),a=cr(a));var u=n||sr?document.importNode(a,!0):a.cloneNode(!0);return Pn(u,u),u}}function Ln(t,r){t!==null&&t.before(r)}function Mn(t,r){return Bn(t,r)}const Tt=new Map;function Bn(t,{target:r,anchor:n,props:a={},events:i,context:u,intro:F=!0}){Kr();var A=new Set,h=p=>{for(var _=0;_<p.length;_++){var P=p[_];if(!A.has(P)){A.add(P);var C=Un(P);r.addEventListener(P,jt,{passive:C});var X=Tt.get(P);X===void 0?(document.addEventListener(P,jt,{passive:C}),Tt.set(P,1)):Tt.set(P,X+1)}}};h(Sr(Dn)),$e.add(h);var f=void 0,d=un(()=>{var p=n??r.appendChild(Qr());return ln(()=>{if(u){or({});var _=H;_.c=u}i&&(a.$$events=i),f=t(p,a)||{},u&&ir()}),()=>{var C;for(var _ of A){r.removeEventListener(_,jt);var P=Tt.get(_);--P===0?(document.removeEventListener(_,jt),Tt.delete(_)):Tt.set(_,P)}$e.delete(h),p!==n&&((C=p.parentNode)==null||C.removeChild(p))}});return Nn.set(f,d),f}let Nn=new WeakMap;function Ke(t,r){return t===r||(t==null?void 0:t[St])===r}function Cn(t={},r,n,a){return Ee(()=>{var i,u;return ae(()=>{i=u,u=[],ue(()=>{t!==n(...u)&&(r(t,...u),i&&Ke(n(...i),t)&&r(null,...i))})}),()=>{dn(()=>{u&&Ke(n(...u),t)&&r(null,...u)})}}),t}function Hn(t=!1){const r=H,n=r.l.u;if(!n)return;let a=()=>gn(r.s);if(t){let i=0,u={};const F=tn(()=>{let A=!1;const h=r.s;for(const f in h)h[f]!==u[f]&&(u[f]=h[f],A=!0);return A&&i++,i});a=()=>o(F)}n.b.length&&on(()=>{Qe(r,a),we(n.b)}),Ye(()=>{const i=ue(()=>n.m.map(Or));return()=>{for(const u of i)typeof u=="function"&&u()}}),n.a.length&&Ye(()=>{Qe(r,a),we(n.a)})}function Qe(t,r){if(t.l.s)for(const n of t.l.s)o(n);r()}const kn="5";var Ze;typeof window<"u"&&((Ze=window.__svelte??(window.__svelte={})).v??(Ze.v=new Set)).add(kn);Yr();const Wn=`#version 300 es
layout (location = 0) in highp vec4 xy_uv;
layout (location = 1) in highp vec4 in_image_xywh;
layout (location = 2) in highp vec4 in_rgba;
layout (location = 3) in lowp vec3 in_discard_wrapx_wrapy;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
out lowp vec3 discard_wrapx_wrapy;
uniform highp vec4 atlas_wh_screen_wh;
void main() {
    rgba = in_rgba;
    uv = xy_uv.pq;
    image_xywh = in_image_xywh;
    discard_wrapx_wrapy = in_discard_wrapx_wrapy;
    gl_Position = vec4(
        (xy_uv.x * 2.0 / atlas_wh_screen_wh.p) - 1.0,
        1.0 - (xy_uv.y * 2.0 / atlas_wh_screen_wh.q),
        0.0,
        1.0
    );
}
`,Xn=`#version 300 es
in highp vec4 rgba;
in highp vec2 uv;
in highp vec4 image_xywh;
in lowp vec3 discard_wrapx_wrapy;
out highp vec4 col;
uniform sampler2D tex;
uniform highp vec4 atlas_wh_screen_wh;
void main() {
    if (discard_wrapx_wrapy.x > 0.5) {
        col = rgba;
    } else {
        highp vec2 atlas_wh = atlas_wh_screen_wh.st;
        highp vec2 mod_atlas_uv = (image_xywh.st + (fract((uv - (image_xywh.st / atlas_wh)) / (image_xywh.pq / atlas_wh)) * image_xywh.pq)) / atlas_wh;
        highp vec2 clamp_atlas_uv = min(max(uv * atlas_wh, image_xywh.st), image_xywh.st + image_xywh.pq) / atlas_wh;
        col = texture(tex, mix(clamp_atlas_uv, mod_atlas_uv, discard_wrapx_wrapy.yz)) * rgba;
    }
}
`,Vn=`#version 300 es
layout (location = 0) in highp vec4 xyz_and_bone;
layout (location = 1) in highp vec2 in_uv;
layout (location = 2) in highp vec4 in_image_xywh;
layout (location = 3) in highp vec4 in_rgba;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 modelmatrix;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    gl_Position = projmatrix * viewmatrix * modelmatrix * vec4(xyz_and_bone.xyz, 1.0);
}
`,jn=`#version 300 es
layout (location = 0) in highp vec4 xyz_and_bone;
layout (location = 1) in highp vec2 in_uv;
layout (location = 2) in highp vec4 in_image_xywh;
layout (location = 3) in highp vec4 in_rgba;
layout (location = 4) in highp mat4 anim;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 modelmatrix;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    gl_Position = projmatrix * viewmatrix * modelmatrix * anim * vec4(xyz_and_bone.xyz, 1.0);
}
`,zn=`#version 300 es
in highp vec4 rgba;
in highp vec2 uv;
in highp vec4 image_xywh;
out highp vec4 col;
uniform sampler2D tex;
void main() {
    col = texture(tex, image_xywh.st + (fract(uv) * image_xywh.pq)) * rgba;
}
`,qn=`#version 300 es
layout (location = 0) in highp vec3 xyz;
layout (location = 1) in highp vec4 in_rgba;
layout (location = 2) in highp vec2 offset2d;
layout (location = 3) in highp vec3 offset3d;
layout (location = 4) in highp vec2 in_uv;
layout (location = 5) in highp vec4 in_image_xywh;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    gl_Position = projmatrix * (vec4(offset2d, 0.0, 0.0) + (viewmatrix * vec4(xyz + offset3d, 1.0)));
}
`,pe=[{count:4,offset:0},{count:4,offset:16},{count:4,offset:32},{count:3,offset:48}],Yn=[{count:4,offset:0},{count:2,offset:16},{count:4,offset:24},{count:4,offset:40}],Gn=[{count:4,offset:0},{count:2,offset:16},{count:4,offset:24},{count:4,offset:40},{count:4,offset:56},{count:4,offset:72},{count:4,offset:88},{count:4,offset:104}],$n=[{count:3,offset:0},{count:4,offset:28},{count:2,offset:44},{count:3,offset:52},{count:2,offset:64},{count:4,offset:12}],Rt=(t,r,n,a)=>{const i=t.createShader(r);if(!i)throw new Error(`failed to create shader '${a}'`);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const u=t.getShaderInfoLog(i);throw new Error(`compilation error in shader '${a}':
${u}`)}return i},zt=(t,r,n,a)=>{const i=t.createProgram();if(!i)throw new Error(`failed to create program '${a}'`);if(t.attachShader(i,r),t.attachShader(i,n),t.linkProgram(i),t.detachShader(i,r),t.detachShader(i,n),!t.getProgramParameter(i,t.LINK_STATUS)){const u=t.getProgramInfoLog(i);throw new Error(`link error in program '${a}':
${u}`)}return i};var Kn=On('<main><canvas class="float-right"></canvas></main>');function Qn(t,r){or(r,!1);let n={},a=[];const i=S=>{const e=Ie.get(S);return e?parseInt(e):0},u=(S,e,c,s,V)=>new Float32Array([c/(S*V),0,0,0,0,c/(e*V),0,0,0,0,(s+c)/(s-c),1,0,0,-2*s*c/(s-c),0]),F=0;let A=B(null),h=B(null),f=B(null),d=B(null),p=B(null),_=B(null),P=B(null),C=B(null),X=B(null),j=B(null),wt=B(null),st=B(null),nt=B(null),Te=B(null),Re=B(null),xt=B(null),ge=B(null),Se=B(null),Ue=B(null),De=B(null);const Ie=new URLSearchParams(window.location.search),Pe=Ie.get("n"),Er=Pe?Math.max(parseInt(Pe),1):1,Ct=i("w"),Ht=i("h"),Oe=i("gx"),Le=i("gy"),se=i("gw"),fe=i("gh");let It=0,kt=B(0),Wt=B(),mt=null,Xt=null,ft=0,lt=0,Me=u(se,fe,460,66560,5/16),Be=!1,$=B(null),l=B(null);const Pt=(S,e,c)=>{S.bindBuffer(S.ARRAY_BUFFER,e.vbo);for(let s=0;s<o(kt);s+=1){const V=e.attribs[s];if(!V){S.disableVertexAttribArray(s);continue}S.enableVertexAttribArray(s),S.vertexAttribPointer(s,V.count,S.FLOAT,!1,e.step,V.offset)}S.drawArrays(S.TRIANGLES,0,c)},yt=(S,e)=>{if(e.viewport(0,0,S.width,S.height),e.scissor(0,0,S.width,S.height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),Be){e.disable(e.SCISSOR_TEST);for(let c of a){if(c.type==="batch2d"){e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST);const s=n[c.textureId];e.useProgram(o(A)),e.viewport(0,0,Ct,Ht),e.uniform4fv(o(h),[s.width,s.height,c.targetWidth,c.targetHeight]),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(o(f),F),Pt(e,c.buffer,c.vertexCount)}if(c.type==="render3d"){e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.DEPTH_TEST);const s=n[c.textureId];e.useProgram(c.animated?o(j):o(d)),e.viewport(Oe,Le,se,fe),e.uniformMatrix4fv(c.animated?o(wt):o(p),!1,c.modelMatrix),e.uniformMatrix4fv(c.animated?o(st):o(_),!1,c.viewMatrix),e.uniformMatrix4fv(c.animated?o(nt):o(P),!1,Me),e.uniform2fv(c.animated?o(Te):o(C),[s.width,s.height]),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(c.animated?o(Re):o(X),F),Pt(e,c.buffer,c.vertexCount)}if(c.type==="renderparticles"){e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.DEPTH_TEST);const s=n[c.textureId];e.useProgram(o(xt)),e.viewport(Oe,Le,se,fe),e.uniformMatrix4fv(o(ge),!1,c.viewMatrix),e.uniformMatrix4fv(o(Se),!1,Me),e.uniform2fv(o(De),[s.width,s.height]),e.bindTexture(e.TEXTURE_2D,s.texture),e.uniform1i(o(Ue),F),Pt(e,c.buffer,c.vertexCount)}if(c.type==="icon"||c.type==="bigicon"){const s=c.texSize;e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.useProgram(o(A)),e.viewport(0,0,Ct,Ht),e.bindTexture(e.TEXTURE_2D,c.texture),e.uniform1i(o(f),F),e.uniform4fv(o(h),[s,s,c.targetWidth,c.targetHeight]),Pt(e,c.buffer,6)}if(c.type==="minimap"){if(mt===null)continue;e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.useProgram(o(A)),e.viewport(0,0,Ct,Ht),e.uniform4fv(o(h),[ft,lt,c.targetWidth,c.targetHeight]),e.bindTexture(e.TEXTURE_2D,mt),e.uniform1i(o(f),F),Pt(e,c.buffer,6)}}}else{e.viewport(0,0,S.width,S.height);const c=()=>{e.clearColor(.525,.968,.495,1),e.clear(e.COLOR_BUFFER_BIT)},s=()=>{e.clearColor(.2,.2,.2,1),e.clear(e.COLOR_BUFFER_BIT)},V=Math.min(It/Er,1),U=Math.floor(S.width*.65)&-2,x=70,I=8,m=I*2,k=U*V;if(c(),S.width<=m||S.height<=m)return;e.scissor(I,I,S.width-m,S.height-m),s(),e.scissor(S.width/2-(U/2+I),S.height/2-(x/2+I),U+m,x+m),c(),e.scissor(S.width/2-U/2+k,S.height/2-x/2,U-k,x),s()}},br=(S,e,c)=>{const s=new DataView(c),V=s.getUint32(0,!0);switch(V){case 0:{Be=!0,yt(S,e);break}case 1:{const U=s.getUint32(4,!0),x=s.getUint32(8,!0),I=s.getUint32(12,!0),m=e.createTexture(),k=new Uint8Array(c,16,x*I*4);e.bindTexture(e.TEXTURE_2D,m),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,x,I,0,e.RGBA,e.UNSIGNED_BYTE,k),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),n[U]={texture:m,width:x,height:I,data:k};break}case 2:case 3:{const U=V===3,x=U?104:40,I=U?120:56,m=s.getUint32(4,!0),k=s.getUint32(8,!0),b=new Float32Array(16);b.set(new Float32Array(c,16,16));const W=new Float32Array(16);W.set(new Float32Array(c,80,16));const R=new DataView(c,144,m*x),g=new Array(m),T=new ArrayBuffer(m*I),w=new DataView(T);for(let E=0;E<m;E+=1){const v=x*E,D=I*E;let K=null;U&&(K=new Float32Array(16),K.set(new Float32Array(c,144+x*E+40,16)));const L={x:R.getInt16(v,!0),y:R.getInt16(v+2,!0),z:R.getInt16(v+4,!0),u:R.getFloat32(v+8,!0),v:R.getFloat32(v+12,!0),ax:R.getUint16(v+16,!0),ay:R.getUint16(v+18,!0),aw:R.getUint16(v+20,!0),ah:R.getUint16(v+22,!0),r:R.getFloat32(v+24,!0),g:R.getFloat32(v+28,!0),b:R.getFloat32(v+32,!0),a:R.getFloat32(v+36,!0),anim:K};if(g[E]=L,w.setFloat32(D,L.x,!0),w.setFloat32(D+4,L.y,!0),w.setFloat32(D+8,L.z,!0),w.setFloat32(D+12,0,!0),w.setFloat32(D+16,L.u,!0),w.setFloat32(D+20,L.v,!0),w.setFloat32(D+24,L.ax,!0),w.setFloat32(D+28,L.ay,!0),w.setFloat32(D+32,L.aw,!0),w.setFloat32(D+36,L.ah,!0),w.setFloat32(D+40,L.r,!0),w.setFloat32(D+44,L.g,!0),w.setFloat32(D+48,L.b,!0),w.setFloat32(D+52,L.a,!0),K)for(let Q=0;Q<16;Q+=1)w.setFloat32(D+56+Q*4,K[Q],!0)}const y=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,y),e.bufferData(e.ARRAY_BUFFER,w,e.STATIC_DRAW),a.push({type:"render3d",animated:U,textureId:k,vertexCount:m,modelMatrix:b,viewMatrix:W,vertices:g,buffer:{vbo:y,step:I,attribs:U?Gn:Yn}}),It+=m,yt(S,e);break}case 4:{const I=s.getUint32(4,!0),m=s.getUint32(8,!0),k=s.getUint16(12,!0),b=s.getUint16(14,!0),W=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,W);const R=new DataView(c,16,I*40),g=new ArrayBuffer(I*60),T=new DataView(g),w=new Array(I);for(let y=0;y<I;y+=1){const E=40*y,v=60*y,D={x:R.getInt16(E,!0),y:R.getInt16(E+2,!0),ax:R.getInt16(E+4,!0),ay:R.getInt16(E+6,!0),aw:R.getInt16(E+8,!0),ah:R.getInt16(E+10,!0),discard:R.getUint8(E+12),wrapx:R.getUint8(E+13),wrapy:R.getUint8(E+14),u:R.getFloat32(E+16,!0),v:R.getFloat32(E+20,!0),r:R.getFloat32(E+24,!0),g:R.getFloat32(E+28,!0),b:R.getFloat32(E+32,!0),a:R.getFloat32(E+36,!0)};w[y]=D,T.setFloat32(v,D.x,!0),T.setFloat32(v+4,D.y,!0),T.setFloat32(v+8,D.u,!0),T.setFloat32(v+12,D.v,!0),T.setFloat32(v+16,D.ax,!0),T.setFloat32(v+20,D.ay,!0),T.setFloat32(v+24,D.aw,!0),T.setFloat32(v+28,D.ah,!0),T.setFloat32(v+32,D.r,!0),T.setFloat32(v+36,D.g,!0),T.setFloat32(v+40,D.b,!0),T.setFloat32(v+44,D.a,!0),T.setFloat32(v+48,D.discard,!0),T.setFloat32(v+52,D.wrapx,!0),T.setFloat32(v+56,D.wrapy,!0)}e.bufferData(e.ARRAY_BUFFER,T,e.STATIC_DRAW),a.push({type:"batch2d",textureId:m,vertexCount:I,vertices:w,targetWidth:k,targetHeight:b,buffer:{vbo:W,step:60,attribs:pe}}),It+=I,yt(S,e);break}case 5:case 8:{const x=V===5?64:512,I=s.getInt16(4,!0),m=s.getInt16(6,!0),k=s.getInt16(8,!0),b=s.getInt16(10,!0),W=s.getUint32(12,!0),R=s.getFloat32(16,!0),g=s.getFloat32(20,!0),T=s.getFloat32(24,!0),w=s.getFloat32(28,!0),y=s.getUint16(32,!0),E=s.getUint16(34,!0),v=e.createTexture(),D=e.createFramebuffer();e.bindTexture(e.TEXTURE_2D,v),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,D),e.texStorage2D(e.TEXTURE_2D,1,e.RGBA8,x,x),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.disable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.FRONT),e.viewport(0,0,x,x),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);let K=Array(W),L=36;for(let _e=0;_e<W;_e+=1){const Vt=s.getUint32(L,!0);let He=Array(Vt);const Rr=new ArrayBuffer(Vt*56),Z=new DataView(Rr),he=new Float32Array(16);he.set(new Float32Array(c,L+4,16));const ve=new Float32Array(16);ve.set(new Float32Array(c,L+68,16));const de=new Float32Array(16);de.set(new Float32Array(c,L+132,16)),L+=196;for(let at=0;at<Vt;at+=1){const ct={x:s.getInt16(L,!0),y:s.getInt16(L+2,!0),z:s.getInt16(L+4,!0),r:s.getFloat32(L+8,!0),g:s.getFloat32(L+12,!0),b:s.getFloat32(L+16,!0),a:s.getFloat32(L+20,!0)},rt=at*56;Z.setFloat32(rt,ct.x,!0),Z.setFloat32(rt+4,ct.y,!0),Z.setFloat32(rt+8,ct.z,!0),Z.setFloat32(rt+24,0,!0),Z.setFloat32(rt+28,0,!0),Z.setFloat32(rt+32,x,!0),Z.setFloat32(rt+36,x,!0),Z.setFloat32(rt+40,ct.r,!0),Z.setFloat32(rt+44,ct.g,!0),Z.setFloat32(rt+48,ct.b,!0),Z.setFloat32(rt+52,ct.a,!0),He[at]=ct,L+=24}K[_e]={vertices:He,modelMatrix:he,viewMatrix:ve,projMatrix:de};const ke=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,ke),e.bufferData(e.ARRAY_BUFFER,Z,e.STATIC_DRAW),e.useProgram(o(d)),e.uniformMatrix4fv(o(p),!1,he),e.uniformMatrix4fv(o(_),!1,ve),e.uniformMatrix4fv(o(P),!1,de),e.uniform2fv(o(C),[1,1]),e.bindTexture(e.TEXTURE_2D,o(Wt)),e.uniform1i(o(X),F);for(let at=0;at<o(kt);at+=1)at<4?e.enableVertexAttribArray(at):e.disableVertexAttribArray(at);e.vertexAttribPointer(0,4,e.FLOAT,!1,56,0),e.vertexAttribPointer(1,2,e.FLOAT,!1,56,16),e.vertexAttribPointer(2,4,e.FLOAT,!1,56,24),e.vertexAttribPointer(3,4,e.FLOAT,!1,56,40),e.drawArrays(e.TRIANGLES,0,Vt),e.deleteBuffer(ke)}const Q=I,bt=I+k,le=m,ce=m+b,Ce=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,Ce),e.bufferData(e.ARRAY_BUFFER,new Float32Array([Q,le,0,1,0,0,x,x,R,T,g,w,0,0,0,bt,le,1,1,0,0,x,x,R,T,g,w,0,0,0,Q,ce,0,0,0,0,x,x,R,T,g,w,0,0,0,bt,le,1,1,0,0,x,x,R,T,g,w,0,0,0,bt,ce,1,0,0,0,x,x,R,T,g,w,0,0,0,Q,ce,0,0,0,0,x,x,R,T,g,w,0,0,0]),e.STATIC_DRAW),a.push({type:V===5?"icon":"bigicon",models:K,texture:v,targetWidth:y,targetHeight:E,texSize:x,buffer:{vbo:Ce,step:60,attribs:pe}}),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.deleteFramebuffer(D),e.disable(e.CULL_FACE);break}case 6:{const U=s.getUint32(4,!0),x=s.getUint32(8,!0);ft=s.getUint16(12,!0),lt=s.getUint16(14,!0);const I=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,I);const m=new DataView(c,16,U*40),k=new ArrayBuffer(U*60),b=new DataView(k),W=new Array(U);for(let g=0;g<U;g+=1){const T=40*g,w=60*g,y={x:m.getInt16(T,!0),y:m.getInt16(T+2,!0),ax:m.getInt16(T+4,!0),ay:m.getInt16(T+6,!0),aw:m.getInt16(T+8,!0),ah:m.getInt16(T+10,!0),discard:m.getUint8(T+12),wrapx:m.getUint8(T+13),wrapy:m.getUint8(T+14),u:m.getFloat32(T+16,!0),v:m.getFloat32(T+20,!0),r:m.getFloat32(T+24,!0),g:m.getFloat32(T+28,!0),b:m.getFloat32(T+32,!0),a:m.getFloat32(T+36,!0)};W[g]=y,b.setFloat32(w,y.x,!0),b.setFloat32(w+4,y.y,!0),b.setFloat32(w+8,y.u,!0),b.setFloat32(w+12,y.v,!0),b.setFloat32(w+16,y.ax,!0),b.setFloat32(w+20,y.ay,!0),b.setFloat32(w+24,y.aw,!0),b.setFloat32(w+28,y.ah,!0),b.setFloat32(w+32,y.r,!0),b.setFloat32(w+36,y.g,!0),b.setFloat32(w+40,y.b,!0),b.setFloat32(w+44,y.a,!0),b.setFloat32(w+48,y.discard,!0),b.setFloat32(w+52,y.wrapx,!0),b.setFloat32(w+56,y.wrapy,!0)}e.bufferData(e.ARRAY_BUFFER,b,e.STATIC_DRAW),!mt||!Xt?(mt=e.createTexture(),e.bindTexture(e.TEXTURE_2D,mt),e.texStorage2D(e.TEXTURE_2D,1,e.RGBA8,ft,lt),Xt=e.createFramebuffer(),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,Xt),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,mt,0),e.bindTexture(e.TEXTURE_2D,null)):e.bindFramebuffer(e.DRAW_FRAMEBUFFER,Xt),e.viewport(0,0,ft,lt),e.scissor(0,0,ft,lt),e.disable(e.DEPTH_TEST);const R=n[x];e.useProgram(o(A)),e.uniform4fv(o(h),[R.width,R.height,ft,lt]),e.bindTexture(e.TEXTURE_2D,R.texture),e.uniform1i(o(f),F);for(let g=0;g<o(kt);g+=1)g<4?e.enableVertexAttribArray(g):e.disableVertexAttribArray(g);e.vertexAttribPointer(0,4,e.FLOAT,!1,60,0),e.vertexAttribPointer(1,4,e.FLOAT,!1,60,16),e.vertexAttribPointer(2,4,e.FLOAT,!1,60,32),e.vertexAttribPointer(3,3,e.FLOAT,!1,60,48),e.drawArrays(e.TRIANGLES,0,U),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),a.push({type:"minimap2d",textureId:x,vbo:I,vertices:W}),It+=U,yt(S,e);break}case 7:{if(!mt)break;const U=s.getInt16(4,!0),x=s.getInt16(6,!0),I=s.getUint16(8,!0),m=s.getUint16(10,!0),k=s.getInt16(12,!0),b=s.getInt16(14,!0),W=s.getUint16(16,!0),R=s.getUint16(18,!0),g=s.getUint16(20,!0),T=s.getUint16(22,!0),w=k,y=k+W,E=b,v=b+R,D=U/ft,K=(U+I)/ft,L=x/lt,Q=(x+m)/lt,bt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,bt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([w,E,D,Q,U,x,I,m,1,1,1,1,0,0,0,y,E,K,Q,U,x,I,m,1,1,1,1,0,0,0,w,v,D,L,U,x,I,m,1,1,1,1,0,0,0,y,E,K,Q,U,x,I,m,1,1,1,1,0,0,0,y,v,K,L,U,x,I,m,1,1,1,1,0,0,0,w,v,D,L,U,x,I,m,1,1,1,1,0,0,0]),e.STATIC_DRAW),a.push({type:"minimap",sourcex:U,sourcey:x,sourcew:I,sourceh:m,targetx:k,targety:b,targetw:W,targeth:R,targetWidth:g,targetHeight:T,buffer:{vbo:bt,step:60,attribs:pe}}),yt(S,e);break}case 9:{const U=s.getUint32(4,!0),x=s.getUint32(8,!0),I=64,m=72,k=new Float32Array(16);k.set(new Float32Array(c,16,16));const b=new DataView(c,80,U*I),W=new Array(U),R=new ArrayBuffer(U*m),g=new DataView(R);for(let w=0;w<U;w+=1){const y=I*w,E=m*w,v={x:b.getFloat32(y,!0),y:b.getFloat32(y+4,!0),z:b.getFloat32(y+8,!0),offsetx2d:b.getFloat32(y+12,!0),offsety2d:b.getFloat32(y+16,!0),offsetx3d:b.getFloat32(y+20,!0),offsety3d:b.getFloat32(y+24,!0),offsetz3d:b.getFloat32(y+28,!0),ax:b.getUint16(y+32,!0),ay:b.getUint16(y+34,!0),aw:b.getUint16(y+36,!0),ah:b.getUint16(y+38,!0),r:b.getFloat32(y+40,!0),g:b.getFloat32(y+44,!0),b:b.getFloat32(y+48,!0),a:b.getFloat32(y+52,!0),u:b.getFloat32(y+56,!0),v:b.getFloat32(y+60,!0)};W[w]=v,g.setFloat32(E,v.x,!0),g.setFloat32(E+4,v.y,!0),g.setFloat32(E+8,v.z,!0),g.setFloat32(E+12,v.ax,!0),g.setFloat32(E+16,v.ay,!0),g.setFloat32(E+20,v.aw,!0),g.setFloat32(E+24,v.ah,!0),g.setFloat32(E+28,v.r,!0),g.setFloat32(E+32,v.g,!0),g.setFloat32(E+36,v.b,!0),g.setFloat32(E+40,v.a,!0),g.setFloat32(E+44,v.offsetx2d,!0),g.setFloat32(E+48,v.offsety2d,!0),g.setFloat32(E+52,v.offsetx3d,!0),g.setFloat32(E+56,v.offsety3d,!0),g.setFloat32(E+60,v.offsetz3d,!0),g.setFloat32(E+64,v.u,!0),g.setFloat32(E+68,v.v,!0)}const T=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,T),e.bufferData(e.ARRAY_BUFFER,g,e.STATIC_DRAW),a.push({type:"renderparticles",textureId:x,vertexCount:U,vertices:W,viewMatrix:k,buffer:{vbo:T,step:m,attribs:$n}}),It+=U,yt(S,e);break}}};window.addEventListener("message",async S=>{if(typeof S.data=="object"&&S.data.type==="pluginMessage"){if(typeof S.data.content!="object"||!o($)||!o(l))return;br(o($),o(l),S.data.content)}}),sn(()=>(o($),o(l),o(Wt),o(A),o(d),o(j),o(xt)),()=>{if(o($)&&(ze($,o($).width=Ct),ze($,o($).height=Ht),O(l,o($).getContext("webgl2")),o(l))){O(kt,o(l).getParameter(o(l).MAX_VERTEX_ATTRIBS)),O(Wt,o(l).createTexture()),o(l).bindTexture(o(l).TEXTURE_2D,o(Wt));const S=new Uint8Array([255,255,255,255]);o(l).texImage2D(o(l).TEXTURE_2D,0,o(l).RGBA,1,1,0,o(l).RGBA,o(l).UNSIGNED_BYTE,S);const e=Rt(o(l),o(l).VERTEX_SHADER,Wn,"2D vertex shader"),c=Rt(o(l),o(l).FRAGMENT_SHADER,Xn,"2D fragment shader"),s=Rt(o(l),o(l).VERTEX_SHADER,Vn,"3D vertex shader"),V=Rt(o(l),o(l).VERTEX_SHADER,jn,"3D anim vertex shader"),U=Rt(o(l),o(l).FRAGMENT_SHADER,zn,"3D fragment shader"),x=Rt(o(l),o(l).VERTEX_SHADER,qn,"particle vertex shader");O(A,zt(o(l),e,c,"2D program")),O(h,o(l).getUniformLocation(o(A),"atlas_wh_screen_wh")),O(f,o(l).getUniformLocation(o(A),"tex")),O(d,zt(o(l),s,U,"3D program")),O(p,o(l).getUniformLocation(o(d),"modelmatrix")),O(_,o(l).getUniformLocation(o(d),"viewmatrix")),O(P,o(l).getUniformLocation(o(d),"projmatrix")),O(C,o(l).getUniformLocation(o(d),"atlas_wh")),O(X,o(l).getUniformLocation(o(d),"tex")),O(j,zt(o(l),V,U,"3D animated program")),O(wt,o(l).getUniformLocation(o(j),"modelmatrix")),O(st,o(l).getUniformLocation(o(j),"viewmatrix")),O(nt,o(l).getUniformLocation(o(j),"projmatrix")),O(Te,o(l).getUniformLocation(o(j),"atlas_wh")),O(Re,o(l).getUniformLocation(o(j),"tex")),O(xt,zt(o(l),x,U,"Particles program")),O(ge,o(l).getUniformLocation(o(xt),"viewmatrix")),O(Se,o(l).getUniformLocation(o(xt),"projmatrix")),O(Ue,o(l).getUniformLocation(o(xt),"tex")),O(De,o(l).getUniformLocation(o(xt),"atlas_wh")),o(l).deleteShader(e),o(l).deleteShader(c),o(l).deleteShader(s),o(l).deleteShader(U),o(l).deleteShader(V),o(l).deleteShader(x),o(l).activeTexture(o(l).TEXTURE0+F),o(l).enable(o(l).SCISSOR_TEST),o(l).disable(o(l).CULL_FACE),o(l).disable(o(l).DEPTH_TEST),o(l).enable(o(l).BLEND),o(l).blendEquationSeparate(o(l).FUNC_ADD,o(l).FUNC_ADD),o(l).depthFunc(o(l).LEQUAL),yt(o($),o(l))}}),fn(),Hn();var Ne=Kn(),Tr=Jr(Ne);Cn(Tr,S=>O($,S),()=>o($)),Ln(t,Ne),ir()}Mn(Qn,{target:document.body});
