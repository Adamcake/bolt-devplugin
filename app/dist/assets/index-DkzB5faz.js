(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function r(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(i){if(i.ep)return;i.ep=!0;const u=r(i);fetch(i.href,u)}})();const In=!1;var pn=Array.isArray,Ta=Array.prototype.indexOf,gn=Array.from,Ra=Object.defineProperty,cr=Object.getOwnPropertyDescriptor,Zn=Object.getOwnPropertyDescriptors,Ba=Object.prototype,Ua=Array.prototype,wn=Object.getPrototypeOf,Dn=Object.isExtensible;function Ia(e){return e()}function cn(e){for(var n=0;n<e.length;n++)e[n]()}const vt=2,Qn=4,jr=8,mn=16,Tt=32,dr=64,Lr=128,ft=256,Vr=512,Je=1024,Rt=2048,tr=4096,Ft=8192,qr=16384,Da=32768,bn=65536,Jn=1<<17,Ma=1<<19,ea=1<<20,dn=1<<21,Jt=Symbol("$state"),$a=Symbol("legacy props"),Pa=Symbol("");function ta(e){return e===this.v}function ka(e,n){return e!=e?n==n:e!==n||e!==null&&typeof e=="object"||typeof e=="function"}function yn(e){return!ka(e,this.v)}function Ca(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function La(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Va(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Na(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Oa(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ha(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Wa(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Xa(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Fr=!1,Ya=!1;function za(){Fr=!0}const En=1,An=2,ra=4,ja=8,qa=16,Ga=1,Ka=2,Za=4,Qa=8,Ja=16,eo=1,to=2,Ze=Symbol(),ro="http://www.w3.org/1999/xhtml";let pe=null;function Mn(e){pe=e}function Yt(e,n=!1,r){var a=pe={p:pe,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};Fr&&!n&&(pe.l={s:null,u:null,r1:[],r2:br(!1)}),fa(()=>{a.d=!0})}function zt(e){const n=pe;if(n!==null){const f=n.e;if(f!==null){var r=ue,a=ne;n.e=null;try{for(var i=0;i<f.length;i++){var u=f[i];Xt(u.effect),mt(u.reaction),Sn(u.fn)}}finally{Xt(r),mt(a)}}pe=n.p,n.m=!0}return{}}function Sr(){return!Fr||pe!==null&&pe.l===null}function Qt(e,n){if(typeof e!="object"||e===null||Jt in e)return e;const r=wn(e);if(r!==Ba&&r!==Ua)return e;var a=new Map,i=pn(e),u=Vt(0),f=ne,h=v=>{var s=ne;mt(f);var _;return _=v(),mt(s),_};return i&&a.set("length",Vt(e.length)),new Proxy(e,{defineProperty(v,s,_){(!("value"in _)||_.configurable===!1||_.enumerable===!1||_.writable===!1)&&Ha();var w=a.get(s);return w===void 0?(w=h(()=>Vt(_.value)),a.set(s,w)):m(w,h(()=>Qt(_.value))),!0},deleteProperty(v,s){var _=a.get(s);if(_===void 0)s in v&&a.set(s,h(()=>Vt(Ze)));else{if(i&&typeof s=="string"){var w=a.get("length"),l=Number(s);Number.isInteger(l)&&l<w.v&&m(w,l)}m(_,Ze),$n(u)}return!0},get(v,s,_){var b;if(s===Jt)return e;var w=a.get(s),l=s in v;if(w===void 0&&(!l||(b=cr(v,s))!=null&&b.writable)&&(w=h(()=>Vt(Qt(l?v[s]:Ze))),a.set(s,w)),w!==void 0){var p=t(w);return p===Ze?void 0:p}return Reflect.get(v,s,_)},getOwnPropertyDescriptor(v,s){var _=Reflect.getOwnPropertyDescriptor(v,s);if(_&&"value"in _){var w=a.get(s);w&&(_.value=t(w))}else if(_===void 0){var l=a.get(s),p=l==null?void 0:l.v;if(l!==void 0&&p!==Ze)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return _},has(v,s){var p;if(s===Jt)return!0;var _=a.get(s),w=_!==void 0&&_.v!==Ze||Reflect.has(v,s);if(_!==void 0||ue!==null&&(!w||(p=cr(v,s))!=null&&p.writable)){_===void 0&&(_=h(()=>Vt(w?Qt(v[s]):Ze)),a.set(s,_));var l=t(_);if(l===Ze)return!1}return w},set(v,s,_,w){var ie;var l=a.get(s),p=s in v;if(i&&s==="length")for(var b=_;b<l.v;b+=1){var L=a.get(b+"");L!==void 0?m(L,Ze):b in v&&(L=h(()=>Vt(Ze)),a.set(b+"",L))}l===void 0?(!p||(ie=cr(v,s))!=null&&ie.writable)&&(l=h(()=>Vt(void 0)),m(l,h(()=>Qt(_))),a.set(s,l)):(p=l.v!==Ze,m(l,h(()=>Qt(_))));var q=Reflect.getOwnPropertyDescriptor(v,s);if(q!=null&&q.set&&q.set.call(w,_),!p){if(i&&typeof s=="string"){var fe=a.get("length"),ce=Number(s);Number.isInteger(ce)&&ce>=fe.v&&m(fe,ce+1)}$n(u)}return!0},ownKeys(v){t(u);var s=Reflect.ownKeys(v).filter(l=>{var p=a.get(l);return p===void 0||p.v!==Ze});for(var[_,w]of a)w.v!==Ze&&!(_ in v)&&s.push(_);return s},setPrototypeOf(){Wa()}})}function $n(e,n=1){m(e,e.v+n)}const mr=new Map;function br(e,n){var r={f:0,v:e,reactions:null,equals:ta,rv:0,wv:0};return r}function Vt(e,n){const r=br(e);return ho(r),r}function M(e,n=!1){var a;const r=br(e);return n||(r.equals=yn),Fr&&pe!==null&&pe.l!==null&&((a=pe.l).s??(a.s=[])).push(r),r}function ot(e,n){return m(e,bt(()=>t(e))),n}function m(e,n,r=!1){ne!==null&&!wt&&Sr()&&(ne.f&(vt|mn))!==0&&!(We!=null&&We.includes(e))&&Xa();let a=r?Qt(n):n;return yr(e,a)}function yr(e,n){if(!e.equals(n)){var r=e.v;Tr?mr.set(e,n):mr.set(e,r),e.v=n,e.wv=pa(),na(e,Rt),Sr()&&ue!==null&&(ue.f&Je)!==0&&(ue.f&(Tt|dr))===0&&(lt===null?po([e]):lt.push(e))}return n}function na(e,n){var r=e.reactions;if(r!==null)for(var a=Sr(),i=r.length,u=0;u<i;u++){var f=r[u],h=f.f;(h&Rt)===0&&(!a&&f===ue||(_t(f,n),(h&(Je|ft))!==0&&((h&vt)!==0?na(f,tr):Qr(f))))}}let no=!1;var Pn,aa,oa,ia;function ao(){if(Pn===void 0){Pn=window,aa=/Firefox/.test(navigator.userAgent);var e=Element.prototype,n=Node.prototype,r=Text.prototype;oa=cr(n,"firstChild").get,ia=cr(n,"nextSibling").get,Dn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Dn(r)&&(r.__t=void 0)}}function Fn(e=""){return document.createTextNode(e)}function Nr(e){return oa.call(e)}function Gr(e){return ia.call(e)}function he(e,n){return Nr(e)}function oe(e,n){{var r=Nr(e);return r instanceof Comment&&r.data===""?Gr(r):r}}function C(e,n=1,r=!1){let a=e;for(;n--;)a=Gr(a);return a}function oo(e){e.textContent=""}function Er(e){var n=vt|Rt,r=ne!==null&&(ne.f&vt)!==0?ne:null;return ue===null||r!==null&&(r.f&ft)!==0?n|=ft:ue.f|=ea,{ctx:pe,deps:null,effects:null,equals:ta,f:n,fn:e,reactions:null,rv:0,v:null,wv:0,parent:r??ue}}function X(e){const n=Er(e);return n.equals=yn,n}function ua(e){var n=e.effects;if(n!==null){e.effects=null;for(var r=0;r<n.length;r+=1)Wt(n[r])}}function io(e){for(var n=e.parent;n!==null;){if((n.f&vt)===0)return n;n=n.parent}return null}function uo(e){var n,r=ue;Xt(io(e));try{ua(e),n=wa(e)}finally{Xt(r)}return n}function sa(e){var n=uo(e),r=(Ht||(e.f&ft)!==0)&&e.deps!==null?tr:Je;_t(e,r),e.equals(n)||(e.v=n,e.wv=pa())}function la(e){ue===null&&ne===null&&Va(),ne!==null&&(ne.f&ft)!==0&&ue===null&&La(),Tr&&Ca()}function so(e,n){var r=n.last;r===null?n.last=n.first=e:(r.next=e,e.prev=r,n.last=e)}function vr(e,n,r,a=!0){var i=ue,u={ctx:pe,deps:null,nodes_start:null,nodes_end:null,f:e|Rt,first:null,fn:n,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0};if(r)try{Zr(u),u.f|=Da}catch(v){throw Wt(u),v}else n!==null&&Qr(u);var f=r&&u.deps===null&&u.first===null&&u.nodes_start===null&&u.teardown===null&&(u.f&(ea|Lr))===0;if(!f&&a&&(i!==null&&so(u,i),ne!==null&&(ne.f&vt)!==0)){var h=ne;(h.effects??(h.effects=[])).push(u)}return u}function fa(e){const n=vr(jr,null,!1);return _t(n,Je),n.teardown=e,n}function kn(e){la();var n=ue!==null&&(ue.f&Tt)!==0&&pe!==null&&!pe.m;if(n){var r=pe;(r.e??(r.e=[])).push({fn:e,effect:ue,reaction:ne})}else{var a=Sn(e);return a}}function lo(e){return la(),_r(e)}function fo(e){const n=vr(dr,e,!0);return(r={})=>new Promise(a=>{r.outro?Or(n,()=>{Wt(n),a(void 0)}):(Wt(n),a(void 0))})}function Sn(e){return vr(Qn,e,!1)}function on(e,n){var r=pe,a={effect:null,ran:!1};r.l.r1.push(a),a.effect=_r(()=>{e(),!a.ran&&(a.ran=!0,m(r.l.r2,!0),bt(n))})}function co(){var e=pe;_r(()=>{if(t(e.l.r2)){for(var n of e.l.r1){var r=n.effect;(r.f&Je)!==0&&_t(r,tr),xr(r)&&Zr(r),n.ran=!1}e.l.r2.v=!1}})}function _r(e){return vr(jr,e,!0)}function ut(e,n=[],r=Er){const a=n.map(r);return Tn(()=>e(...a.map(t)))}function Tn(e,n=0){return vr(jr|mn|n,e,!0)}function Ar(e,n=!0){return vr(jr|Tt,e,!0,n)}function ca(e){var n=e.teardown;if(n!==null){const r=Tr,a=ne;Cn(!0),mt(null);try{n.call(null)}finally{Cn(r),mt(a)}}}function da(e,n=!1){var r=e.first;for(e.first=e.last=null;r!==null;){var a=r.next;(r.f&dr)!==0?r.parent=null:Wt(r,n),r=a}}function vo(e){for(var n=e.first;n!==null;){var r=n.next;(n.f&Tt)===0&&Wt(n),n=r}}function Wt(e,n=!0){var r=!1;if((n||(e.f&Ma)!==0)&&e.nodes_start!==null){for(var a=e.nodes_start,i=e.nodes_end;a!==null;){var u=a===i?null:Gr(a);a.remove(),a=u}r=!0}da(e,n&&!r),zr(e,0),_t(e,qr);var f=e.transitions;if(f!==null)for(const v of f)v.stop();ca(e);var h=e.parent;h!==null&&h.first!==null&&va(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=null}function va(e){var n=e.parent,r=e.prev,a=e.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),n!==null&&(n.first===e&&(n.first=a),n.last===e&&(n.last=r))}function Or(e,n){var r=[];Rn(e,r,!0),_a(r,()=>{Wt(e),n&&n()})}function _a(e,n){var r=e.length;if(r>0){var a=()=>--r||n();for(var i of e)i.out(a)}else n()}function Rn(e,n,r){if((e.f&Ft)===0){if(e.f^=Ft,e.transitions!==null)for(const f of e.transitions)(f.is_global||r)&&n.push(f);for(var a=e.first;a!==null;){var i=a.next,u=(a.f&bn)!==0||(a.f&Tt)!==0;Rn(a,n,u?r:!1),a=i}}}function Hr(e){xa(e,!0)}function xa(e,n){if((e.f&Ft)!==0){e.f^=Ft,(e.f&Je)===0&&(e.f^=Je),xr(e)&&(_t(e,Rt),Qr(e));for(var r=e.first;r!==null;){var a=r.next,i=(r.f&bn)!==0||(r.f&Tt)!==0;xa(r,i?n:!1),r=a}if(e.transitions!==null)for(const u of e.transitions)(u.is_global||n)&&u.in()}}let Wr=[];function _o(){var e=Wr;Wr=[],cn(e)}function Bn(e){Wr.length===0&&queueMicrotask(_o),Wr.push(e)}let Pr=!1,vn=!1,Xr=null,er=!1,Tr=!1;function Cn(e){Tr=e}let kr=[];let ne=null,wt=!1;function mt(e){ne=e}let ue=null;function Xt(e){ue=e}let We=null;function xo(e){We=e}function ho(e){ne!==null&&ne.f&dn&&(We===null?xo([e]):We.push(e))}let He=null,it=0,lt=null;function po(e){lt=e}let ha=1,Yr=0,Ht=!1,Ot=null;function pa(){return++ha}function xr(e){var w;var n=e.f;if((n&Rt)!==0)return!0;if((n&tr)!==0){var r=e.deps,a=(n&ft)!==0;if(r!==null){var i,u,f=(n&Vr)!==0,h=a&&ue!==null&&!Ht,v=r.length;if(f||h){var s=e,_=s.parent;for(i=0;i<v;i++)u=r[i],(f||!((w=u==null?void 0:u.reactions)!=null&&w.includes(s)))&&(u.reactions??(u.reactions=[])).push(s);f&&(s.f^=Vr),h&&_!==null&&(_.f&ft)===0&&(s.f^=ft)}for(i=0;i<v;i++)if(u=r[i],xr(u)&&sa(u),u.wv>e.wv)return!0}(!a||ue!==null&&!Ht)&&_t(e,Je)}return!1}function go(e,n){for(var r=n;r!==null;){if((r.f&Lr)!==0)try{r.fn(e);return}catch{r.f^=Lr}r=r.parent}throw Pr=!1,e}function wo(e){return(e.f&qr)===0&&(e.parent===null||(e.parent.f&Lr)===0)}function Kr(e,n,r,a){if(Pr){if(r===null&&(Pr=!1),wo(n))throw e;return}r!==null&&(Pr=!0);{go(e,n);return}}function ga(e,n,r=!0){var a=e.reactions;if(a!==null)for(var i=0;i<a.length;i++){var u=a[i];We!=null&&We.includes(e)||((u.f&vt)!==0?ga(u,n,!1):n===u&&(r?_t(u,Rt):(u.f&Je)!==0&&_t(u,tr),Qr(u)))}}function wa(e){var p;var n=He,r=it,a=lt,i=ne,u=Ht,f=We,h=pe,v=wt,s=e.f;He=null,it=0,lt=null,Ht=(s&ft)!==0&&(wt||!er||ne===null),ne=(s&(Tt|dr))===0?e:null,We=null,Mn(e.ctx),wt=!1,Yr++,e.f|=dn;try{var _=(0,e.fn)(),w=e.deps;if(He!==null){var l;if(zr(e,it),w!==null&&it>0)for(w.length=it+He.length,l=0;l<He.length;l++)w[it+l]=He[l];else e.deps=w=He;if(!Ht)for(l=it;l<w.length;l++)((p=w[l]).reactions??(p.reactions=[])).push(e)}else w!==null&&it<w.length&&(zr(e,it),w.length=it);if(Sr()&&lt!==null&&!wt&&w!==null&&(e.f&(vt|tr|Rt))===0)for(l=0;l<lt.length;l++)ga(lt[l],e);return i!==null&&(Yr++,lt!==null&&(a===null?a=lt:a.push(...lt))),_}finally{He=n,it=r,lt=a,ne=i,Ht=u,We=f,Mn(h),wt=v,e.f^=dn}}function mo(e,n){let r=n.reactions;if(r!==null){var a=Ta.call(r,e);if(a!==-1){var i=r.length-1;i===0?r=n.reactions=null:(r[a]=r[i],r.pop())}}r===null&&(n.f&vt)!==0&&(He===null||!He.includes(n))&&(_t(n,tr),(n.f&(ft|Vr))===0&&(n.f^=Vr),ua(n),zr(n,0))}function zr(e,n){var r=e.deps;if(r!==null)for(var a=n;a<r.length;a++)mo(e,r[a])}function Zr(e){var n=e.f;if((n&qr)===0){_t(e,Je);var r=ue,a=pe,i=er;ue=e,er=!0;try{(n&mn)!==0?vo(e):da(e),ca(e);var u=wa(e);e.teardown=typeof u=="function"?u:null,e.wv=ha;var f=e.deps,h;In&&Ya&&e.f&Rt}catch(v){Kr(v,e,r,a||e.ctx)}finally{er=i,ue=r}}}function bo(){try{Na()}catch(e){if(Xr!==null)Kr(e,Xr,null);else throw e}}function yo(){var e=er;try{var n=0;for(er=!0;kr.length>0;){n++>1e3&&bo();var r=kr,a=r.length;kr=[];for(var i=0;i<a;i++){var u=Ao(r[i]);Eo(u)}}}finally{vn=!1,er=e,Xr=null,mr.clear()}}function Eo(e){var n=e.length;if(n!==0)for(var r=0;r<n;r++){var a=e[r];if((a.f&(qr|Ft))===0)try{xr(a)&&(Zr(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?va(a):a.fn=null))}catch(i){Kr(i,a,null,a.ctx)}}}function Qr(e){vn||(vn=!0,queueMicrotask(yo));for(var n=Xr=e;n.parent!==null;){n=n.parent;var r=n.f;if((r&(dr|Tt))!==0){if((r&Je)===0)return;n.f^=Je}}kr.push(n)}function Ao(e){for(var n=[],r=e;r!==null;){var a=r.f,i=(a&(Tt|dr))!==0,u=i&&(a&Je)!==0;if(!u&&(a&Ft)===0){if((a&Qn)!==0)n.push(r);else if(i)r.f^=Je;else{var f=ne;try{ne=r,xr(r)&&Zr(r)}catch(s){Kr(s,r,null,r.ctx)}finally{ne=f}}var h=r.first;if(h!==null){r=h;continue}}var v=r.parent;for(r=r.next;r===null&&v!==null;)r=v.next,v=v.parent}return n}function t(e){var n=e.f,r=(n&vt)!==0;if(Ot!==null&&Ot.add(e),ne!==null&&!wt){if(!(We!=null&&We.includes(e))){var a=ne.deps;e.rv<Yr&&(e.rv=Yr,He===null&&a!==null&&a[it]===e?it++:He===null?He=[e]:(!Ht||!He.includes(e))&&He.push(e))}}else if(r&&e.deps===null&&e.effects===null){var i=e,u=i.parent;u!==null&&(u.f&ft)===0&&(i.f^=ft)}return r&&(i=e,xr(i)&&sa(i)),Tr&&mr.has(e)?mr.get(e):e.v}function Fo(e){var n=Ot;Ot=new Set;var r=Ot,a;try{if(bt(e),n!==null)for(a of Ot)n.add(a)}finally{Ot=n}return r}function Qe(e){var n=Fo(()=>bt(e));for(var r of n)if((r.f&Jn)!==0)for(const a of r.deps||[])(a.f&vt)===0&&yr(a,a.v);else yr(r,r.v)}function bt(e){var n=wt;try{return wt=!0,e()}finally{wt=n}}const So=-7169;function _t(e,n){e.f=e.f&So|n}function To(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Jt in e)_n(e);else if(!Array.isArray(e))for(let n in e){const r=e[n];typeof r=="object"&&r&&Jt in r&&_n(r)}}}function _n(e,n=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!n.has(e)){n.add(e),e instanceof Date&&e.getTime();for(let a in e)try{_n(e[a],n)}catch{}const r=wn(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const a=Zn(r);for(let i in a){const u=a[i].get;if(u)try{u.call(e)}catch{}}}}}const Ro=["touchstart","touchmove"];function Bo(e){return Ro.includes(e)}let Ln=!1;function Uo(){Ln||(Ln=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var n;if(!e.defaultPrevented)for(const r of e.target.elements)(n=r.__on_r)==null||n.call(r)})},{capture:!0}))}function ma(e){var n=ne,r=ue;mt(null),Xt(null);try{return e()}finally{mt(n),Xt(r)}}function ba(e,n,r,a=r){e.addEventListener(n,()=>ma(r));const i=e.__on_r;i?e.__on_r=()=>{i(),a(!0)}:e.__on_r=()=>a(!0),Uo()}const ya=new Set,xn=new Set;function Io(e,n,r,a={}){function i(u){if(a.capture||wr.call(n,u),!u.cancelBubble)return ma(()=>r==null?void 0:r.call(this,u))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Bn(()=>{n.addEventListener(e,i,a)}):n.addEventListener(e,i,a),i}function Oe(e,n,r,a,i){var u={capture:a,passive:i},f=Io(e,n,r,u);(n===document.body||n===window||n===document)&&fa(()=>{n.removeEventListener(e,f,u)})}function rr(e){for(var n=0;n<e.length;n++)ya.add(e[n]);for(var r of xn)r(e)}function wr(e){var ce;var n=this,r=n.ownerDocument,a=e.type,i=((ce=e.composedPath)==null?void 0:ce.call(e))||[],u=i[0]||e.target,f=0,h=e.__root;if(h){var v=i.indexOf(h);if(v!==-1&&(n===document||n===window)){e.__root=n;return}var s=i.indexOf(n);if(s===-1)return;v<=s&&(f=v)}if(u=i[f]||e.target,u!==n){Ra(e,"currentTarget",{configurable:!0,get(){return u||r}});var _=ne,w=ue;mt(null),Xt(null);try{for(var l,p=[];u!==null;){var b=u.assignedSlot||u.parentNode||u.host||null;try{var L=u["__"+a];if(L!=null&&(!u.disabled||e.target===u))if(pn(L)){var[q,...fe]=L;q.apply(u,[e,...fe])}else L.call(u,e)}catch(ie){l?p.push(ie):l=ie}if(e.cancelBubble||b===n||b===null)break;u=b}if(l){for(let ie of p)queueMicrotask(()=>{throw ie});throw l}}finally{e.__root=n,delete e.currentTarget,mt(_),Xt(w)}}}function Do(e){var n=document.createElement("template");return n.innerHTML=e,n.content}function hn(e,n){var r=ue;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=n)}function O(e,n){var r=(n&eo)!==0,a=(n&to)!==0,i,u=!e.startsWith("<!>");return()=>{i===void 0&&(i=Do(u?e:"<!>"+e),r||(i=Nr(i)));var f=a||aa?document.importNode(i,!0):i.cloneNode(!0);if(r){var h=Nr(f),v=f.lastChild;hn(h,v)}else hn(f,f);return f}}function Mr(){var e=document.createDocumentFragment(),n=document.createComment(""),r=Fn();return e.append(n,r),hn(n,r),e}function N(e,n){e!==null&&e.before(n)}function me(e,n){var r=n==null?"":typeof n=="object"?n+"":n;r!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=r,e.nodeValue=r+"")}function Mo(e,n){return $o(e,n)}const ur=new Map;function $o(e,{target:n,anchor:r,props:a={},events:i,context:u,intro:f=!0}){ao();var h=new Set,v=w=>{for(var l=0;l<w.length;l++){var p=w[l];if(!h.has(p)){h.add(p);var b=Bo(p);n.addEventListener(p,wr,{passive:b});var L=ur.get(p);L===void 0?(document.addEventListener(p,wr,{passive:b}),ur.set(p,1)):ur.set(p,L+1)}}};v(gn(ya)),xn.add(v);var s=void 0,_=fo(()=>{var w=r??n.appendChild(Fn());return Ar(()=>{if(u){Yt({});var l=pe;l.c=u}i&&(a.$$events=i),s=e(w,a)||{},u&&zt()}),()=>{var b;for(var l of h){n.removeEventListener(l,wr);var p=ur.get(l);--p===0?(document.removeEventListener(l,wr),ur.delete(l)):ur.set(l,p)}xn.delete(v),w!==r&&((b=w.parentNode)==null||b.removeChild(w))}});return Po.set(s,_),s}let Po=new WeakMap;function ee(e,n,[r,a]=[0,0]){var i=e,u=null,f=null,h=Ze,v=r>0?bn:0,s=!1;const _=(l,p=!0)=>{s=!0,w(p,l)},w=(l,p)=>{h!==(h=l)&&(h?(u?Hr(u):p&&(u=Ar(()=>p(i))),f&&Or(f,()=>{f=null})):(f?Hr(f):p&&(f=Ar(()=>p(i,[r+1,a]))),u&&Or(u,()=>{u=null})))};Tn(()=>{s=!1,n(_),s||w(null,null)},v)}function Et(e,n){return n}function ko(e,n,r,a){for(var i=[],u=n.length,f=0;f<u;f++)Rn(n[f].e,i,!0);var h=u>0&&i.length===0&&r!==null;if(h){var v=r.parentNode;oo(v),v.append(r),a.clear(),Nt(e,n[0].prev,n[u-1].next)}_a(i,()=>{for(var s=0;s<u;s++){var _=n[s];h||(a.delete(_.k),Nt(e,_.prev,_.next)),Wt(_.e,!h)}})}function At(e,n,r,a,i,u=null){var f=e,h={flags:n,items:new Map,first:null},v=(n&ra)!==0;if(v){var s=e;f=s.appendChild(Fn())}var _=null,w=!1,l=X(()=>{var p=r();return pn(p)?p:p==null?[]:gn(p)});Tn(()=>{var p=t(l),b=p.length;w&&b===0||(w=b===0,Co(p,h,f,i,n,a,r),u!==null&&(b===0?_?Hr(_):_=Ar(()=>u(f)):_!==null&&Or(_,()=>{_=null})),t(l))})}function Co(e,n,r,a,i,u,f){var qt,Bt,Gt,Ut;var h=(i&ja)!==0,v=(i&(En|An))!==0,s=e.length,_=n.items,w=n.first,l=w,p,b=null,L,q=[],fe=[],ce,ie,H,W;if(h)for(W=0;W<s;W+=1)ce=e[W],ie=u(ce,W),H=_.get(ie),H!==void 0&&((qt=H.a)==null||qt.measure(),(L??(L=new Set)).add(H));for(W=0;W<s;W+=1){if(ce=e[W],ie=u(ce,W),H=_.get(ie),H===void 0){var Q=l?l.e.nodes_start:r;b=Vo(Q,n,b,b===null?n.first:b.next,ce,ie,W,a,i,f),_.set(ie,b),q=[],fe=[],l=b.next;continue}if(v&&Lo(H,ce,W,i),(H.e.f&Ft)!==0&&(Hr(H.e),h&&((Bt=H.a)==null||Bt.unfix(),(L??(L=new Set)).delete(H))),H!==l){if(p!==void 0&&p.has(H)){if(q.length<fe.length){var K=fe[0],Z;b=K.prev;var ve=q[0],ke=q[q.length-1];for(Z=0;Z<q.length;Z+=1)Vn(q[Z],K,r);for(Z=0;Z<fe.length;Z+=1)p.delete(fe[Z]);Nt(n,ve.prev,ke.next),Nt(n,b,ve),Nt(n,ke,K),l=K,b=ke,W-=1,q=[],fe=[]}else p.delete(H),Vn(H,l,r),Nt(n,H.prev,H.next),Nt(n,H,b===null?n.first:b.next),Nt(n,b,H),b=H;continue}for(q=[],fe=[];l!==null&&l.k!==ie;)(l.e.f&Ft)===0&&(p??(p=new Set)).add(l),fe.push(l),l=l.next;if(l===null)continue;H=l}q.push(H),b=H,l=H.next}if(l!==null||p!==void 0){for(var et=p===void 0?[]:gn(p);l!==null;)(l.e.f&Ft)===0&&et.push(l),l=l.next;var Le=et.length;if(Le>0){var jt=(i&ra)!==0&&s===0?r:null;if(h){for(W=0;W<Le;W+=1)(Gt=et[W].a)==null||Gt.measure();for(W=0;W<Le;W+=1)(Ut=et[W].a)==null||Ut.fix()}ko(n,et,jt,_)}}h&&Bn(()=>{var It;if(L!==void 0)for(H of L)(It=H.a)==null||It.apply()}),ue.first=n.first&&n.first.e,ue.last=b&&b.e}function Lo(e,n,r,a){(a&En)!==0&&yr(e.v,n),(a&An)!==0?yr(e.i,r):e.i=r}function Vo(e,n,r,a,i,u,f,h,v,s){var _=(v&En)!==0,w=(v&qa)===0,l=_?w?M(i):br(i):i,p=(v&An)===0?f:br(f),b={i:p,v:l,k:u,a:null,e:null,prev:r,next:a};try{return b.e=Ar(()=>h(e,l,p,s),no),b.e.prev=r&&r.e,b.e.next=a&&a.e,r===null?n.first=b:(r.next=b,r.e.next=b.e),a!==null&&(a.prev=b,a.e.prev=b.e),b}finally{}}function Vn(e,n,r){for(var a=e.next?e.next.e.nodes_start:r,i=n?n.e.nodes_start:r,u=e.e.nodes_start;u!==a;){var f=Gr(u);i.before(u),u=f}}function Nt(e,n,r){n===null?e.first=r:(n.next=r,n.e.next=r&&r.e),r!==null&&(r.prev=n,r.e.prev=n&&n.e)}function Ea(e){var n,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(n=0;n<i;n++)e[n]&&(r=Ea(e[n]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function No(){for(var e,n,r=0,a="",i=arguments.length;r<i;r++)(e=arguments[r])&&(n=Ea(e))&&(a&&(a+=" "),a+=n);return a}function Oo(e){return typeof e=="object"?No(e):e??""}function Ho(e,n,r){var a=e==null?"":""+e;return a===""?null:a}function Nn(e,n,r,a,i,u){var f=e.__className;if(f!==r){var h=Ho(r);h==null?e.removeAttribute("class"):e.className=h,e.__className=r}return u}const Wo=Symbol("is custom element"),Xo=Symbol("is html");function sr(e,n,r,a){var i=Yo(e);i[n]!==(i[n]=r)&&(n==="loading"&&(e[Pa]=r),r==null?e.removeAttribute(n):typeof r!="string"&&zo(e).includes(n)?e[n]=r:e.setAttribute(n,r))}function Yo(e){return e.__attributes??(e.__attributes={[Wo]:e.nodeName.includes("-"),[Xo]:e.namespaceURI===ro})}var On=new Map;function zo(e){var n=On.get(e.nodeName);if(n)return n;On.set(e.nodeName,n=[]);for(var r,a=e,i=Element.prototype;i!==a;){r=Zn(a);for(var u in r)r[u].set&&n.push(u);a=wn(a)}return n}function Cr(e,n,r=n){var a=Sr();ba(e,"input",i=>{var u=i?e.defaultValue:e.value;if(u=un(e)?sn(u):u,r(u),a&&u!==(u=n())){var f=e.selectionStart,h=e.selectionEnd;e.value=u??"",h!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(h,e.value.length))}}),bt(n)==null&&e.value&&r(un(e)?sn(e.value):e.value),_r(()=>{var i=n();un(e)&&i===sn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Aa(e,n,r=n){ba(e,"change",a=>{var i=a?e.defaultChecked:e.checked;r(i)}),bt(n)==null&&r(e.checked),_r(()=>{var a=n();e.checked=!!a})}function un(e){var n=e.type;return n==="number"||n==="range"}function sn(e){return e===""?null:+e}function Hn(e,n){return e===n||(e==null?void 0:e[Jt])===n}function Fa(e={},n,r,a){return Sn(()=>{var i,u;return _r(()=>{i=u,u=[],bt(()=>{e!==r(...u)&&(n(e,...u),i&&Hn(r(...i),e)&&n(null,...i))})}),()=>{Bn(()=>{u&&Hn(r(...u),e)&&n(null,...u)})}}),e}function nr(e=!1){const n=pe,r=n.l.u;if(!r)return;let a=()=>To(n.s);if(e){let i=0,u={};const f=Er(()=>{let h=!1;const v=n.s;for(const s in v)v[s]!==u[s]&&(u[s]=v[s],h=!0);return h&&i++,i});a=()=>t(f)}r.b.length&&lo(()=>{Wn(n,a),cn(r.b)}),kn(()=>{const i=bt(()=>r.m.map(Ia));return()=>{for(const u of i)typeof u=="function"&&u()}}),r.a.length&&kn(()=>{Wn(n,a),cn(r.a)})}function Wn(e,n){if(e.l.s)for(const r of e.l.s)t(r);n()}let $r=!1;function jo(e){var n=$r;try{return $r=!1,[e(),$r]}finally{$r=n}}function Xn(e){var n;return((n=e.ctx)==null?void 0:n.d)??!1}function Pe(e,n,r,a){var K;var i=(r&Ga)!==0,u=!Fr||(r&Ka)!==0,f=(r&Qa)!==0,h=(r&Ja)!==0,v=!1,s;f?[s,v]=jo(()=>e[n]):s=e[n];var _=Jt in e||$a in e,w=f&&(((K=cr(e,n))==null?void 0:K.set)??(_&&n in e&&(Z=>e[n]=Z)))||void 0,l=a,p=!0,b=!1,L=()=>(b=!0,p&&(p=!1,h?l=bt(a):l=a),l);s===void 0&&a!==void 0&&(w&&u&&Oa(),s=L(),w&&w(s));var q;if(u)q=()=>{var Z=e[n];return Z===void 0?L():(p=!0,b=!1,Z)};else{var fe=(i?Er:X)(()=>e[n]);fe.f|=Jn,q=()=>{var Z=t(fe);return Z!==void 0&&(l=void 0),Z===void 0?l:Z}}if((r&Za)===0)return q;if(w){var ce=e.$$legacy;return function(Z,ve){return arguments.length>0?((!u||!ve||ce||v)&&w(ve?q():Z),Z):q()}}var ie=!1,H=!1,W=M(s),Q=Er(()=>{var Z=q(),ve=t(W);return ie?(ie=!1,H=!0,ve):(H=!1,W.v=Z)});return f&&t(Q),i||(Q.equals=yn),function(Z,ve){if(Ot!==null&&(ie=H,q(),t(W)),arguments.length>0){const ke=ve?t(Q):u&&f?Qt(Z):Z;if(!Q.equals(ke)){if(ie=!0,m(W,ke),b&&l!==void 0&&(l=ke),Xn(Q))return Z;bt(()=>t(Q))}return Z}return Xn(Q)?Q.v:t(Q)}}const qo="5";var Kn;typeof window<"u"&&((Kn=window.__svelte??(window.__svelte={})).v??(Kn.v=new Set)).add(qo);za();const Go=`#version 300 es
layout (location = 0) in highp vec4 xy_uv;
layout (location = 1) in highp vec4 in_image_xywh;
layout (location = 2) in highp vec4 in_rgba;
layout (location = 3) in lowp vec3 in_discard_wrapx_wrapy;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
out lowp vec3 discard_wrapx_wrapy;
uniform highp vec4 atlas_wh_screen_wh;
void main() {
    rgba = in_rgba;
    uv = xy_uv.pq;
    image_xywh = in_image_xywh;
    discard_wrapx_wrapy = in_discard_wrapx_wrapy;
    gl_Position = vec4(
        (xy_uv.x * 2.0 / atlas_wh_screen_wh.p) - 1.0,
        1.0 - (xy_uv.y * 2.0 / atlas_wh_screen_wh.q),
        0.0,
        1.0
    );
}
`,Ko=`#version 300 es
in highp vec4 rgba;
in highp vec2 uv;
in highp vec4 image_xywh;
in lowp vec3 discard_wrapx_wrapy;
out highp vec4 col;
uniform sampler2D tex;
uniform highp vec4 atlas_wh_screen_wh;
void main() {
    if (discard_wrapx_wrapy.x > 0.5) {
        col = rgba;
    } else {
        highp vec2 atlas_wh = atlas_wh_screen_wh.st;
        highp vec2 mod_atlas_uv = (image_xywh.st + (fract((uv - (image_xywh.st / atlas_wh)) / (image_xywh.pq / atlas_wh)) * image_xywh.pq)) / atlas_wh;
        highp vec2 clamp_atlas_uv = min(max(uv * atlas_wh, image_xywh.st), image_xywh.st + image_xywh.pq) / atlas_wh;
        col = texture(tex, mix(clamp_atlas_uv, mod_atlas_uv, discard_wrapx_wrapy.yz)) * rgba;
    }
}
`,Zo=`#version 300 es
layout (location = 0) in highp vec4 xyz_and_bone;
layout (location = 1) in highp vec2 in_uv;
layout (location = 2) in highp vec4 in_image_xywh;
layout (location = 3) in highp vec4 in_rgba;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 modelmatrix;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    gl_Position = projmatrix * viewmatrix * modelmatrix * vec4(xyz_and_bone.xyz, 1.0);
}
`,Qo=`#version 300 es
layout (location = 0) in highp vec4 xyz_and_bone;
layout (location = 1) in highp vec2 in_uv;
layout (location = 2) in highp vec4 in_image_xywh;
layout (location = 3) in highp vec4 in_rgba;
layout (location = 4) in highp mat4 anim;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 modelmatrix;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    gl_Position = projmatrix * viewmatrix * modelmatrix * anim * vec4(xyz_and_bone.xyz, 1.0);
}
`,Jo=`#version 300 es
in highp vec4 rgba;
in highp vec2 uv;
in highp vec4 image_xywh;
out highp vec4 col;
uniform sampler2D tex;
void main() {
    col = texture(tex, image_xywh.st + (fract(uv) * image_xywh.pq)) * rgba;
}
`,ei=`#version 300 es
layout (location = 0) in highp vec3 xyz;
layout (location = 1) in highp vec4 in_rgba;
layout (location = 2) in highp vec2 offset2d;
layout (location = 3) in highp vec3 offset3d;
layout (location = 4) in highp vec2 in_uv;
layout (location = 5) in highp vec4 in_image_xywh;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    mat4 eyetranslation = mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0,
        offset2d, 0.0, 1.0);
    gl_Position = projmatrix * eyetranslation * viewmatrix * vec4(xyz + offset3d, 1.0);
}
`,ti=`#version 300 es
layout (location = 0) in highp vec2 in_xy;
out highp vec2 xy;
uniform highp vec2 screen_wh;
void main() {
    xy = in_xy;
    gl_Position = vec4(
        in_xy.x * 2.0 - 1.0,
        in_xy.y * 2.0 - 1.0,
        0.0,
        1.0
    );
}
`,ri=`#version 300 es
in highp vec2 xy;
out highp vec4 col;
uniform highp vec2 screen_wh;
void main() {
    highp float xpixel = xy.x * screen_wh.s;
    highp float ypixel = xy.y * screen_wh.t;
    highp float rgb = mod(floor(xpixel / 24.0) + floor(ypixel / 24.0), 2.0) >= 1.0 ? 0.8 : 0.7;
    col = vec4(rgb, rgb, rgb, 1.0);
}
`,ni=`#version 300 es
layout (location = 0) in highp vec4 xyz_and_bone;
layout (location = 1) in highp vec2 in_uv;
layout (location = 2) in highp vec4 in_image_xywh;
layout (location = 3) in highp vec4 in_rgba;
layout (location = 4) in highp vec2 in_offset;
out highp vec4 rgba;
out highp vec2 uv;
out highp vec4 image_xywh;
uniform mat4 modelmatrix;
uniform mat4 viewmatrix;
uniform mat4 projmatrix;
uniform highp vec2 atlas_wh;
void main() {
    rgba = in_rgba;
    uv = in_uv;
    image_xywh = vec4(
        in_image_xywh.s / atlas_wh.s,
        in_image_xywh.t / atlas_wh.t,
        in_image_xywh.p / atlas_wh.s,
        in_image_xywh.q / atlas_wh.t
    );
    mat4 eyetranslation = mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0,
        in_offset.x, in_offset.y, 0.0, 1.0);
    gl_Position = projmatrix * eyetranslation * viewmatrix * modelmatrix * vec4(xyz_and_bone.xyz, 1.0);
}
`,lr=[{count:4,offset:0},{count:4,offset:16},{count:4,offset:32},{count:3,offset:48}],Yn=[{count:4,offset:0},{count:2,offset:16},{count:4,offset:24},{count:4,offset:40}],ai=[{count:4,offset:0},{count:2,offset:16},{count:4,offset:24},{count:4,offset:40},{count:4,offset:56},{count:4,offset:72},{count:4,offset:88},{count:4,offset:104}],oi=[{count:3,offset:0},{count:4,offset:28},{count:2,offset:44},{count:3,offset:52},{count:2,offset:64},{count:4,offset:12}],ii=[{count:4,offset:0},{count:2,offset:16},{count:4,offset:24},{count:4,offset:40},{count:2,offset:56}],ui=[{count:2,offset:0}],yt=(e,n,r,a)=>{const i=e.createShader(n);if(!i)throw new Error(`failed to create shader '${a}'`);if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){const u=e.getShaderInfoLog(i);throw new Error(`compilation error in shader '${a}':
${u}`)}return i},fr=(e,n,r,a)=>{const i=e.createProgram();if(!i)throw new Error(`failed to create program '${a}'`);if(e.attachShader(i,n),e.attachShader(i,r),e.linkProgram(i),e.detachShader(i,n),e.detachShader(i,r),!e.getProgramParameter(i,e.LINK_STATUS)){const u=e.getProgramInfoLog(i);throw new Error(`link error in program '${a}':
${u}`)}return i};function*si(e,n){let r=0;for(;!(r>e.length);){const a=r+n;yield e.slice(r,a),r=a}}function*li(e,n){let r=0;for(;;){const a=r+n;if(a>e.length)break;yield e.slice(r,a),r=a}}function ln(e,n,r,a){const i=n*2,u=e.map(r);return u.length<i?u:si(u,n).map(f=>[...f]).map(a).toArray()}function St(e){return Math.round(e*255)}let gt=null;const fi=(e,n,r,a)=>{gt={value:e,level:n,draggedID:r,set:a}},ci=()=>{gt=null},di=(e,n,r)=>{!gt||gt.level!==e||gt.draggedID===n||(gt.set&&(gt.set(gt.value),gt.set=null),r(gt.value))};var vi=(e,n)=>n(!1),_i=O('<button class="h-4 w-4 rounded-lg hover:bg-white"><img src="plugin://app/images/caret-down-solid.svg" class="h-full w-full" alt="hide"></button>'),xi=(e,n)=>n(!0),hi=O('<button class="h-4 w-4 rounded-lg hover:bg-white"><img src="plugin://app/images/caret-down-solid.svg" class="h-full w-full rotate-270" alt="expand"></button>'),pi=O('<input type="checkbox">'),gi=O("<!> <!> <label> </label> <br>",1);function Ne(e,n){Yt(n,!1);let r=Pe(n,"expanded",12),a=Pe(n,"id",8),i=Pe(n,"text",8),u=Pe(n,"checked",12,null),f=Pe(n,"level",8),h=Pe(n,"onexpandedchange",8,null),v=Pe(n,"oncheckedchange",8,null);const s=Q=>{r(Q),h()&&h()()},_=Q=>{u(Q),v()&&v()()},w=()=>fi(!u(),f(),a(),_),l=()=>di(f(),a(),_),p=ci;nr();var b=gi(),L=oe(b);{var q=Q=>{var K=_i();K.__click=[vi,s],ut(()=>sr(K,"id",u()===null?a():null)),N(Q,K)},fe=Q=>{var K=hi();K.__click=[xi,s],ut(()=>sr(K,"id",u()===null?a():null)),N(Q,K)};ee(L,Q=>{r()?Q(q):Q(fe,!1)})}var ce=C(L,2);{var ie=Q=>{var K=pi();sr(K,"draggable",!0),K.__change=function(...Z){var ve;(ve=v())==null||ve.apply(this,Z)},ut(()=>sr(K,"id",a())),Oe("dragstart",K,w),Oe("dragenter",K,l),Oe("dragend",K,p),Aa(K,u),N(Q,K)};ee(ce,Q=>{u()!==null&&Q(ie)})}var H=C(ce,2);sr(H,"draggable",!0),H.__change=function(...Q){var K;(K=v())==null||K.apply(this,Q)};var W=he(H);ut(()=>{sr(H,"for",a()),me(W,i())}),Oe("dragstart",H,w),Oe("dragenter",H,l),Oe("dragend",H,p),N(e,b),zt()}rr(["click","change"]);var wi=(e,n,r)=>n()(r()),mi=O('<button class="px-1 bg-gray-200 hover:bg-gray-100">view image</button> <br>',1),bi=O('<div class="ml-2 w-full"><!> <br> <br> <br> <br></div>');function zn(e,n){Yt(n,!1);let r=Pe(n,"image",8),a=Pe(n,"view",8,null);nr();var i=bi(),u=he(i);{var f=w=>{var l=mi(),p=oe(l);p.__click=[wi,a,r],N(w,l)};ee(u,w=>{a()&&w(f)})}var h=C(u),v=C(h,2),s=C(v,2),_=C(s,2);ut((w,l,p,b)=>{me(h,` screen: ${r().x??""},${r().y??""}
  ${r().w??""}x${r().h??""} `),me(v,` atlas: ${r().ax??""},${r().ay??""}
  ${r().aw??""}x${r().ah??""} `),me(s,` rgb: ${w??""}, ${l??""}, ${p??""} `),me(_,` alpha: ${b??""} `)},[()=>St(r().r),()=>St(r().g),()=>St(r().b),()=>r().a.toPrecision(4)],X),N(e,i),zt()}rr(["click"]);var yi=(e,n,r)=>n()(r()),Ei=O('<button class="px-1 bg-gray-200 hover:bg-gray-100">view texture</button> <br>',1),Ai=O(" <br>",1),Fi=O('<div class="ml-2 w-full"><!> <!> <br> <br> <br> <br></div>');function jn(e,n){Yt(n,!1);let r=Pe(n,"vertex",8),a=Pe(n,"view",8,null);nr();var i=Fi(),u=he(i);{var f=p=>{var b=Ei(),L=oe(b);L.__click=[yi,a,r],N(p,b)};ee(u,p=>{a()&&p(f)})}var h=C(u,2);{var v=p=>{var b=Ai(),L=oe(b);ut(()=>me(L,`model: ${r().modelpoint.x??""},${r().modelpoint.y??""},${r().modelpoint.z??""} `)),N(p,b)};ee(h,p=>{r().modelpoint&&p(v)})}var s=C(h),_=C(s,2),w=C(_,2),l=C(w,2);ut((p,b,L,q,fe,ce)=>{me(s,` atlas: ${r().ax??""},${r().ay??""}
  ${r().aw??""}x${r().ah??""} `),me(_,` uv: ${p??""}, ${b??""} `),me(w,` rgb: ${L??""}, ${q??""}, ${fe??""} `),me(l,` alpha: ${ce??""} `)},[()=>r().u.toPrecision(4),()=>r().v.toPrecision(4),()=>St(r().r),()=>St(r().g),()=>St(r().b),()=>r().a.toPrecision(4)],X),N(e,i),zt()}rr(["click"]);var Si=O('<div class="ml-2 w-full"> <br> <br> <br></div>');function qn(e,n){Yt(n,!1);let r=Pe(n,"vertex",8);nr();var a=Si(),i=he(a),u=C(i,2),f=C(u,2);ut((h,v,s,_)=>{me(i,`model: ${r().modelpoint.x??""},${r().modelpoint.y??""},${r().modelpoint.z??""} `),me(u,` rgb: ${h??""}, ${v??""}, ${s??""} `),me(f,` alpha: ${_??""} `)},[()=>St(r().r),()=>St(r().g),()=>St(r().b),()=>r().a.toPrecision(4)],X),N(e,a),zt()}var Ti=O("<div> </div>"),Ri=(e,n,r)=>{const a=n().textureId,i=r().textures[a];r(r().selectedTextureId=a.toString(),!0),r(r().selectedTexture=i,!0),r(r().textureBoundX=0,!0),r(r().textureBoundY=0,!0),r(r().textureBoundW=i.width,!0),r(r().textureBoundH=i.height,!0),r(r().textureViewX=0,!0),r(r().textureViewY=0,!0),r(r().textureViewScale=100,!0),r(r().viewIsWholeAtlas=!0,!0),r().redraw()},Bi=O('<button class="px-1 bg-gray-200 hover:bg-gray-100"> </button> <br>',1),Ui=O("<!> <!>",1),Ii=O('<div class="ml-1"></div>'),Di=O("<!> <!>",1),Mi=O("<!> <!>",1),$i=O('<div class="ml-1"><!></div>'),Pi=O("<!> <!>",1),ki=O("<!> <!>",1),Ci=O('<div class="ml-1"></div>'),Li=O("<!> <!>",1),Vi=O("<!> <!>",1),Ni=O('<div class="ml-1"><!></div>'),Oi=O("<!> <!>",1),Hi=O("<!> <!>",1),Wi=O('<div class="ml-1"></div>'),Xi=O("<!> <!>",1),Yi=O("<!> <!>",1),zi=O('<div class="ml-1"><!></div>'),ji=O("<!> <!>",1),qi=O('<div class="ml-1"><!> <!></div>'),Gi=O(" <br> <!> <!>",1),Ki=O('<div class="ml-3 text-sm"><!> <!> <!> <!> <!></div>');function Zi(e,n){Yt(n,!1);let r=Pe(n,"entity",12),a=Pe(n,"menuData",12),i=Pe(n,"level",8);const u=6,f=100;let h=M(!1),v=M(!1),s=M(!1);function _(U){return"images"in U}function w(U){return"vertices"in U}function l(U){return"vertices"in U}const p=(U,J)=>{const Y=U[0];let ge=Y.x,Xe=Y.x,Ye=Y.y,tt=Y.y;for(const se of U)se.x<ge&&(ge=se.x),se.x>Xe&&(Xe=se.x),se.y<Ye&&(Ye=se.y),se.y>tt&&(tt=se.y);return{x:ge,y:Ye,w:Xe-ge,h:tt-Ye,ax:Y.ax,ay:Y.ay,aw:Y.aw,ah:Y.ah,r:Y.r,g:Y.g,b:Y.b,a:Y.a,expanded:!1,index:J}},b=(U,J)=>{const Y=J*f,ge=Y*u;return{images:U,desc:`${Y}-${Y+U.length-1}`,expanded:!1,vertexRangeStart:ge,vertexRangeEnd:ge+U.length*u}},L=(U,J)=>({modelpoint:{...U},expanded:!1,index:J,...U}),q=(U,J)=>({modelpoint:null,expanded:!1,index:J,...U}),fe=(U,J)=>{const Y=J*f;return{vertices:U,desc:`${Y}-${Y+U.length-1}`,expanded:!1}},ce=(U,J)=>({modelpoint:{...U},expanded:!1,index:J,...U}),ie=(U,J)=>{const Y=J*f;return{vertices:U,desc:`${Y}-${Y+U.length-1}`,expanded:!1}},H=(U,J)=>({vertices:ln(U.vertices,f,ce,ie),vertexCount:U.vertices.length,expanded:!1,verticesExpanded:!1,index:J});let W=M(null),Q=M(0),K=M(null),Z=M(0),ve=M(null),ke=M(0);if(r().type==="batch2d"||r().type==="minimap2d"||r().type==="billboard"){const U=[...li(r().vertices,u)];m(Q,U.length),m(W,ln(U,f,p,b))}else if(r().vertices){const U=r().type!=="renderparticles"?L:q;m(Z,r().vertices.length),m(K,ln(r().vertices,f,U,fe))}r().models&&(m(ke,r().models.length),m(ve,r().models.map(H)));const et=U=>{const J=r().textureId,Y=a().textures[J];a(a().selectedTextureId=r().uuid,!0),a(a().selectedTexture=Y,!0),a(a().textureBoundX=U.ax,!0),a(a().textureBoundY=U.ay,!0),a(a().textureBoundW=U.aw,!0),a(a().textureBoundH=U.ah,!0),a(a().textureViewX=0,!0),a(a().textureViewY=0,!0),a(a().textureViewScale=100,!0),a(a().viewIsWholeAtlas=!1,!0),a().redraw()};nr();var Le=Ki(),jt=he(Le);{var qt=U=>{var J=Ti(),Y=he(J);ut(()=>me(Y,`animated: ${r().animated??""}`)),N(U,J)};ee(jt,U=>{typeof r().animated=="boolean"&&U(qt)})}var Bt=C(jt,2);{var Gt=U=>{var J=Bi(),Y=oe(J);Y.__click=[Ri,r,a];var ge=he(Y);ut(()=>me(ge,`texture: #${r().textureId??""}`)),N(U,J)};ee(Bt,U=>{typeof r().textureId=="number"&&U(Gt)})}var Ut=C(Bt,2);{var It=U=>{var J=Pi(),Y=oe(J);const ge=X(()=>`${r().uuid}-images2d`),Xe=X(()=>`2D images (${t(Q)})`);Ne(Y,{get id(){return t(ge)},get text(){return t(Xe)},get level(){return i()},get expanded(){return t(h)},set expanded(se){m(h,se)},$$legacy:!0});var Ye=C(Y,2);{var tt=se=>{var Ve=Mr(),rt=oe(Ve);At(rt,1,()=>t(W),Et,(Dt,z,de)=>{var nt=$i(),ze=he(nt);{var je=be=>{var Be=Di(),Ue=oe(Be),qe=()=>t(z).images.every(_e=>r().enabledVerticesList[_e.index*u]),ye=_e=>{for(let Ee=t(z).vertexRangeStart;Ee<t(z).vertexRangeEnd;Ee+=1)r(r().enabledVerticesList[Ee]=_e,!0)};const Fe=X(()=>`${r().uuid}-images-${t(z).desc}`),Se=X(()=>`[Images ${t(z).desc}]`),Ie=X(()=>i()+1);Ne(Ue,{get checked(){return qe()},set checked(_e){ye(_e)},get oncheckedchange(){return a().redraw},get id(){return t(Fe)},get text(){return t(Se)},get level(){return t(Ie)},get expanded(){return t(z).expanded},set expanded(_e){t(z).expanded=_e,Qe(()=>t(W))},$$legacy:!0});var xe=C(Ue,2);{var we=_e=>{var Ee=Ii();At(Ee,5,()=>t(z).images,Et,(Ce,Te,le)=>{var x=Ui(),te=oe(x),De=()=>r().enabledVerticesList[t(Te).index*u],Mt=Me=>{for(let Ge=0;Ge<u;Ge+=1)r(r().enabledVerticesList[t(Te).index*u+Ge]=Me,!0)};const $t=X(()=>`${r().uuid}-images-${t(z).desc}-${le}`),ct=X(()=>i()+2);Ne(te,{get checked(){return De()},set checked(Me){Mt(Me)},get oncheckedchange(){return a().redraw},get id(){return t($t)},text:`Image ${de*f+le}`,get level(){return t(ct)},get expanded(){return t(Te).expanded},set expanded(Me){t(Te).expanded=Me,Qe(()=>(t(W),t(z).images))},$$legacy:!0});var Pt=C(te,2);{var ht=Me=>{zn(Me,{get image(){return t(Te)},view:et})};ee(Pt,Me=>{t(Te).expanded&&Me(ht)})}N(Ce,x)}),N(_e,Ee)};ee(xe,_e=>{t(z).expanded&&_e(we)})}N(be,Be)},xt=be=>{var Be=Mi(),Ue=oe(Be),qe=()=>r().enabledVerticesList[t(z).index*u],ye=we=>{for(let _e=0;_e<u;_e+=1)r(r().enabledVerticesList[t(z).index*u+_e]=we,!0)};const Fe=X(()=>`${r().uuid}-images-${de}`),Se=X(()=>i()+1);Ne(Ue,{get checked(){return qe()},set checked(we){ye(we)},get oncheckedchange(){return a().redraw},get id(){return t(Fe)},text:`Image ${de}`,get level(){return t(Se)},get expanded(){return t(z).expanded},set expanded(we){t(z).expanded=we,Qe(()=>t(W))},$$legacy:!0});var Ie=C(Ue,2);{var xe=we=>{zn(we,{get image(){return t(z)},view:et})};ee(Ie,we=>{t(z).expanded&&we(xe)})}N(be,Be)};ee(ze,be=>{_(t(z))?be(je):be(xt,!1)})}N(Dt,nt)}),N(se,Ve)};ee(Ye,se=>{t(h)&&se(tt)})}N(U,J)};ee(Ut,U=>{t(W)&&t(Q)&&U(It)})}var Rr=C(Ut,2);{var Br=U=>{var J=Oi(),Y=oe(J);const ge=X(()=>`${r().uuid}-vertices3d`),Xe=X(()=>`3D vertices (${t(Z)})`);Ne(Y,{get id(){return t(ge)},get text(){return t(Xe)},get level(){return i()},get expanded(){return t(v)},set expanded(se){m(v,se)},$$legacy:!0});var Ye=C(Y,2);{var tt=se=>{var Ve=Mr(),rt=oe(Ve);At(rt,1,()=>t(K),Et,(Dt,z,de)=>{var nt=Ni(),ze=he(nt);{var je=be=>{var Be=Li(),Ue=oe(Be);const qe=X(()=>`${r().uuid}-vertices-${t(z).desc}`),ye=X(()=>`[Vertices ${t(z).desc}]`),Fe=X(()=>i()+1);Ne(Ue,{get id(){return t(qe)},get text(){return t(ye)},get level(){return t(Fe)},get expanded(){return t(z).expanded},set expanded(xe){t(z).expanded=xe,Qe(()=>t(K))},$$legacy:!0});var Se=C(Ue,2);{var Ie=xe=>{var we=Ci();At(we,5,()=>t(z).vertices,Et,(_e,Ee,Ce)=>{var Te=ki(),le=oe(Te);const x=X(()=>`${r().uuid}-vertices-${t(z).desc}-${t(Ee).index}`),te=X(()=>`Vertex ${t(Ee).index}`),De=X(()=>i()+2);Ne(le,{get id(){return t(x)},get text(){return t(te)},get level(){return t(De)},get expanded(){return t(Ee).expanded},set expanded(ct){t(Ee).expanded=ct,Qe(()=>(t(K),t(z).vertices))},$$legacy:!0});var Mt=C(le,2);{var $t=ct=>{jn(ct,{get vertex(){return t(Ee)},view:et})};ee(Mt,ct=>{t(Ee).expanded&&ct($t)})}N(_e,Te)}),N(xe,we)};ee(Se,xe=>{t(z).expanded&&xe(Ie)})}N(be,Be)},xt=be=>{var Be=Vi(),Ue=oe(Be);const qe=X(()=>`${r().uuid}-vertices-${t(z).index}`),ye=X(()=>`Vertex ${t(z).index}`),Fe=X(()=>i()+1);Ne(Ue,{get id(){return t(qe)},get text(){return t(ye)},get level(){return t(Fe)},get expanded(){return t(z).expanded},set expanded(xe){t(z).expanded=xe,Qe(()=>t(K))},$$legacy:!0});var Se=C(Ue,2);{var Ie=xe=>{jn(xe,{get vertex(){return t(z)},view:et})};ee(Se,xe=>{t(z).expanded&&xe(Ie)})}N(be,Be)};ee(ze,be=>{w(t(z))?be(je):be(xt,!1)})}N(Dt,nt)}),N(se,Ve)};ee(Ye,se=>{t(v)&&se(tt)})}N(U,J)};ee(Rr,U=>{t(K)&&t(Z)&&U(Br)})}var Ur=C(Rr,2);{var Jr=U=>{var J=Gi(),Y=oe(J),ge=C(Y,3);const Xe=X(()=>`${r().uuid}-models`),Ye=X(()=>`Models (${t(ke)})`);Ne(ge,{get id(){return t(Xe)},get text(){return t(Ye)},get level(){return i()},get expanded(){return t(s)},set expanded(Ve){m(s,Ve)},$$legacy:!0});var tt=C(ge,2);{var se=Ve=>{var rt=Mr(),Dt=oe(rt);At(Dt,1,()=>t(ve),Et,(z,de,nt)=>{var ze=qi(),je=he(ze);const xt=X(()=>`${r().uuid}-models`),be=X(()=>`Model ${t(de).index}`),Be=X(()=>i()+1);Ne(je,{get id(){return t(xt)},get text(){return t(be)},get level(){return t(Be)},get expanded(){return t(de).expanded},set expanded(ye){t(de).expanded=ye,Qe(()=>t(ve))},$$legacy:!0});var Ue=C(je,2);{var qe=ye=>{var Fe=ji(),Se=oe(Fe);const Ie=X(()=>`${r().uuid}-vertices`),xe=X(()=>`Vertices (${t(de).vertexCount})`),we=X(()=>i()+2);Ne(Se,{get id(){return t(Ie)},get text(){return t(xe)},get level(){return t(we)},get expanded(){return t(de).verticesExpanded},set expanded(Ce){t(de).verticesExpanded=Ce,Qe(()=>t(ve))},$$legacy:!0});var _e=C(Se,2);{var Ee=Ce=>{var Te=Mr(),le=oe(Te);At(le,1,()=>t(de).vertices,Et,(x,te,De)=>{var Mt=zi(),$t=he(Mt);{var ct=ht=>{var Me=Xi(),Ge=oe(Me);const ar=X(()=>`${r().uuid}-vertices-${t(te).desc}`),pt=X(()=>`[Vertices ${t(te).desc}]`),or=X(()=>i()+3);Ne(Ge,{get id(){return t(ar)},get text(){return t(pt)},get level(){return t(or)},get expanded(){return t(te).expanded},set expanded(Ke){t(te).expanded=Ke,Qe(()=>(t(ve),t(de).vertices))},$$legacy:!0});var hr=C(Ge,2);{var pr=Ke=>{var Ir=Wi();At(Ir,5,()=>t(te).vertices,Et,(en,kt,g)=>{var o=Hi(),c=oe(o);const d=X(()=>`${r().uuid}-vertices-${t(te).desc}-${t(kt).index}`),G=X(()=>`Vertex ${t(kt).index}`),F=X(()=>i()+4);Ne(c,{get id(){return t(d)},get text(){return t(G)},get level(){return t(F)},get expanded(){return t(kt).expanded},set expanded(T){t(kt).expanded=T,Qe(()=>(t(ve),t(de).vertices,t(te).vertices))},$$legacy:!0});var S=C(c,2);{var I=T=>{qn(T,{get vertex(){return t(kt)}})};ee(S,T=>{t(kt).expanded&&T(I)})}N(en,o)}),N(Ke,Ir)};ee(hr,Ke=>{t(te).expanded&&Ke(pr)})}N(ht,Me)},Pt=ht=>{var Me=Yi(),Ge=oe(Me);const ar=X(()=>`${r().uuid}-${t(de).index}-vertex-${t(te).index}`),pt=X(()=>`Vertex ${t(te).index}`),or=X(()=>i()+3);Ne(Ge,{get id(){return t(ar)},get text(){return t(pt)},get level(){return t(or)},get expanded(){return t(te).expanded},set expanded(Ke){t(te).expanded=Ke,Qe(()=>(t(ve),t(de).vertices))},$$legacy:!0});var hr=C(Ge,2);{var pr=Ke=>{qn(Ke,{get vertex(){return t(te)}})};ee(hr,Ke=>{t(te).expanded&&Ke(pr)})}N(ht,Me)};ee($t,ht=>{l(t(te))?ht(ct):ht(Pt,!1)})}N(x,Mt)}),N(Ce,Te)};ee(_e,Ce=>{t(de).verticesExpanded&&Ce(Ee)})}N(ye,Fe)};ee(Ue,ye=>{t(de).expanded&&ye(qe)})}N(z,ze)}),N(Ve,rt)};ee(tt,Ve=>{t(s)&&Ve(se)})}ut(()=>me(Y,`screen: ${r().targetx??""},${r().targety??""}
    ${r().targetw??""}x${r().targeth??""} `)),N(U,J)};ee(Ur,U=>{t(ve)&&t(ke)&&U(Jr)})}N(e,Le),zt()}rr(["click"]);var Qi=(e,n,r,a)=>n(r(),a()),Ji=O('<div class="static select-none m-0 border-none w-full text-left"><button> </button></div>'),eu=O("<div><!> <!></div>"),tu=O('<div class="static select-none m-0 border-none w-full"><b>All textures</b></div> <!> <br> <div class="static select-none m-0 border-none w-full"><b>All entities</b></div> <!>',1);function ru(e,n){Yt(n,!1);let r=Pe(n,"data",12);const a=(v,s)=>{r().selectedTexture===s?r(r().selectedTexture=null,!0):(r(r().selectedTextureId=v,!0),r(r().selectedTexture=s,!0),r(r().textureBoundX=0,!0),r(r().textureBoundY=0,!0),r(r().textureBoundW=s.width,!0),r(r().textureBoundH=s.height,!0),r(r().textureViewX=0,!0),r(r().textureViewY=0,!0),r(r().textureViewScale=100,!0),r(r().viewIsWholeAtlas=!0,!0)),r().redraw()},i=1;nr();var u=tu(),f=C(oe(u),2);At(f,1,()=>Object.entries(r().textures),Et,(v,s)=>{let _=()=>t(s)[0],w=()=>t(s)[1];var l=Ji(),p=he(l);p.__click=[Qi,a,_,w];var b=he(p);ut(()=>{Nn(p,1,Oo(r().selectedTexture===w()?"bg-rose-400 hover:bg-rose-500 w-full":"bg-slate-300 hover:bg-slate-400 w-full")),me(b,`#${_()??""}`)}),N(v,l)});var h=C(f,6);At(h,1,()=>r().entities,Et,(v,s,_)=>{var w=eu();Nn(w,1,`select-none m-0 border-none w-full ${_&1?"bg-[#c4c4e4]":"bg-[#b8b8d8]"}`);var l=he(w);Ne(l,{id:`menu${_}`,get text(){return r().entities[_].type},get oncheckedchange(){return r().redraw},level:i,get expanded(){return r().entities[_].expanded},set expanded(L){r().entities[_].expanded=L,Qe(()=>r().entities)},get checked(){return r().entities[_].enabled},set checked(L){r().entities[_].enabled=L,Qe(()=>r().entities)},$$legacy:!0});var p=C(l,2);{var b=L=>{Zi(L,{level:i+1,get entity(){return r().entities[_]},set entity(q){r().entities[_]=q,Qe(()=>r().entities)},get menuData(){return r()},set menuData(q){r(q)},$$legacy:!0})};ee(p,L=>{r().entities[_].expanded&&L(b)})}N(v,w)}),N(e,u),zt()}rr(["click"]);const $e=[];for(let e=0;e<256;++e)$e.push((e+256).toString(16).slice(1));function nu(e,n=0){return($e[e[n+0]]+$e[e[n+1]]+$e[e[n+2]]+$e[e[n+3]]+"-"+$e[e[n+4]]+$e[e[n+5]]+"-"+$e[e[n+6]]+$e[e[n+7]]+"-"+$e[e[n+8]]+$e[e[n+9]]+"-"+$e[e[n+10]]+$e[e[n+11]]+$e[e[n+12]]+$e[e[n+13]]+$e[e[n+14]]+$e[e[n+15]]).toLowerCase()}let fn;const au=new Uint8Array(16);function ou(){if(!fn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");fn=crypto.getRandomValues.bind(crypto)}return fn(au)}const iu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Gn={randomUUID:iu};function Zt(e,n,r){var i;if(Gn.randomUUID&&!e)return Gn.randomUUID();e=e||{};const a=e.random??((i=e.rng)==null?void 0:i.call(e))??ou();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,nu(a)}const uu=(e,n)=>t(n).select();var su=(e,n)=>{e.key==="Escape"&&(e.preventDefault(),n(null))},lu=(e,n)=>n(null),fu=O('<div class="absolute backdrop-blur-sm h-full w-full left-0 top-0 m-0 p-12 overflow-none focus-visible:outline-none"><div class="w-full h-full p-4 bg-slate-100 rounded-lg flex flex-col"><textarea class="w-full flex-grow border border-black resize-none rounded-md"></textarea> <button class="w-full h-fit rounded-sm p-2 mt-1 text-xl font-bold bg-blue-500 opacity-90 hover:opacity-100">Select all</button></div></div> <input type="image" src="plugin://app/images/xmark-solid.svg" class="absolute right-0 top-0 rounded-sm m-4 p-1 w-8 h-8 bg-gray-200 opacity-75 hover:opacity-100" alt="close">',1);function cu(e,n){let r=Pe(n,"text",12),a=M();var i=fu(),u=oe(i);u.__keydown=[su,r];var f=he(u),h=he(f);Fa(h,_=>m(a,_),()=>t(a));var v=C(h,2);v.__click=[uu,a];var s=C(u,2);s.__click=[lu,r],Cr(h,r),N(e,i)}rr(["keydown","click"]);const du=(e,n,r,a,i,u,f,h)=>{const v=t(n).selectedTexture;if(!v){m(r,"error: no texture selected");return}if(t(a)===null||t(a)<0||t(a)>=t(n).textureBoundH){m(r,"error: selected row is out-of-bounds");return}const s=t(i)?t(u):0,_=t(n).textureBoundX+s,w=t(a)+t(n).textureBoundY,l=t(i)?t(f)+1-t(u):t(n).textureBoundW;if(s<0||s+l>t(n).textureBoundW){m(r,"error: selection is out-of-bounds");return}const p=(w*v.width+_)*4,b=v.data.slice(p,p+l*4),L=h(b);m(r,`'${L}'`)};var vu=(e,n,r)=>m(n,r),_u=(e,n,r)=>m(n,r),xu=(e,n)=>m(n,!1),hu=O('<div class="overflow-auto absolute w-60 h-full left-0 top-0 m-0 p-0 bg-slate-200"><!></div> <input type="image" src="plugin://app/images/bars-solid.svg" class="absolute rounded-sm mx-61 my-6 p-1 w-9 h-9 bg-gray-200 opacity-75 hover:opacity-100" alt="hide menu">',1),pu=(e,n)=>m(n,!0),gu=O('<input type="image" src="plugin://app/images/bars-solid.svg" class="absolute rounded-sm m-6 p-1 w-9 h-9 bg-gray-200 opacity-75 hover:opacity-100" alt="show menu">'),wu=(e,n,r,a,i)=>{ot(n,t(n).selectedTexture=null),r(t(a),t(i))},mu=O('<input type="image" src="plugin://app/images/xmark-solid.svg" class="absolute right-0 rounded-sm m-4 p-1 w-8 h-8 bg-gray-200 opacity-75 hover:opacity-100" alt="close">'),bu=O('<input type="checkbox"> from x: <input class="w-14 border border-black" type="number"> to <input class="w-14 border border-black" type="number">',1),yu=O('RGBA data for all rows: <input class="w-4 h-4 opacity-75 hover:opacity-100" type="image" src="plugin://app/images/clipboard-solid.svg" alt="copy">',1),Eu=O('<!> <div class="absolute top-1 w-full h-fit grid place-items-center pointer-events-none"><div class="w-fit h-full rounded-lg bg-gray-100 pointer-events-auto px-2 py-1"><div class="w-16 h-full table-cell"> <br> </div> <div class="w-28 h-full table-cell px-1 mx-1"> <br> </div> <div class="w-fit h-full table-cell px-1">RGBA data for row: <input class="w-18 border border-black" type="number"> <input class="w-4 h-4 opacity-75 enabled:hover:opacity-100" type="image" src="plugin://app/images/clipboard-solid.svg" alt="copy"> <br> <!></div></div></div>',1),Au=O('<canvas class="absolute right-0"></canvas> <!> <!> <!>',1);function Fu(e,n){Yt(n,!1);const r=M();let a=M({textures:{},entities:[],selectedTexture:null,selectedTextureId:"",textureBoundX:0,textureBoundY:0,textureBoundW:1,textureBoundH:1,textureViewX:0,textureViewY:0,textureViewScale:100,viewIsWholeAtlas:!1,redraw:()=>De(t(le),t(x))});const i=g=>{const o=U.get(g);return o?parseInt(o):0},u=0;let f=M(null),h=M(null),v=M(null),s=M(null),_=M(null),w=M(null),l=M(null),p=M(null),b=M(null),L=M(null),q=M(null),fe=M(null),ce=M(null),ie=M(null),H=M(null),W=M(null),Q=M(null),K=M(null),Z=M(null),ve=M(null),ke=M(null),et=M(null),Le=M(null),jt=M(null),qt=M(null),Bt=M(null),Gt=M(null),Ut=M(null),It=null;const Rr=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),Br=10,Ur=1e3,Jr=10,U=new URLSearchParams(window.location.search),J=U.get("n"),Y=J?Math.max(parseInt(J),1):1,ge=i("w"),Xe=i("h"),Ye=i("gx"),tt=i("gy"),se=i("gw"),Ve=i("gh");let rt=0,Dt=M(0),z=M(),de=null,nt=null,ze=0,je=0,xt,be,Be=M(!1),Ue=M(!1),qe=M(null),ye=M(null),Fe=M(null),Se=M(null),Ie=M(!1),xe=M(!1),we=M(!1),_e=M(!1),Ee=M(!1),Ce=M(null),Te=M(!1),le=M(null),x=M(null);const te=(g,o,c,d)=>{g.bindBuffer(g.ARRAY_BUFFER,o.vbo);for(let F=0;F<t(Dt);F+=1){const S=o.attribs[F];if(!S){g.disableVertexAttribArray(F);continue}g.enableVertexAttribArray(F),g.vertexAttribPointer(F,S.count,g.FLOAT,!1,o.step,S.offset)}if(!d){g.drawArrays(g.TRIANGLES,0,c);return}let G=null;for(let F=0;F<c;F+=1){const S=d[F];G===null?S&&(G=F):S||(g.drawArrays(g.TRIANGLES,G,F-G),G=null)}G!==null&&g.drawArrays(g.TRIANGLES,G,c-G)},De=(g,o)=>{if(o.viewport(0,0,g.width,g.height),o.scissor(0,0,g.width,g.height),o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),!t(Be)){o.viewport(0,0,g.width,g.height);const c=()=>{o.clearColor(.525,.968,.495,1),o.clear(o.COLOR_BUFFER_BIT)},d=()=>{o.clearColor(.2,.2,.2,1),o.clear(o.COLOR_BUFFER_BIT)},G=Math.min(rt/Y,1),F=Math.floor(g.width*.65)&-2,S=70,I=8,T=I*2,k=F*G;if(c(),g.width<=T||g.height<=T)return;o.scissor(I,I,g.width-T,g.height-T),d(),o.scissor(g.width/2-(F/2+I),g.height/2-(S/2+I),F+T,S+T),c(),o.scissor(g.width/2-F/2+k,g.height/2-S/2,F-k,S),d();return}if(t(a).selectedTexture){t(a).textureViewScale<Br&&ot(a,t(a).textureViewScale=Br),t(a).textureViewScale>Ur&&ot(a,t(a).textureViewScale=Ur);const c=t(a).textureViewScale/100,d=c*2,G=t(a).textureBoundX,F=t(a).textureBoundX+t(a).textureBoundW,S=t(a).textureBoundY,I=t(a).textureBoundY+t(a).textureBoundH;let T=t(a).textureViewX+g.width/d,k=t(a).textureViewY+g.height/d,P=!1;if(T<G&&(T=G,P=!0),k<S&&(k=S,P=!0),T>F&&(T=F,P=!0),k>I&&(k=I,P=!0),t(a).textureBoundW*c<=g.width&&(T=G+t(a).textureBoundW/2,P=!0),t(a).textureBoundH*c<=g.height&&(k=S+t(a).textureBoundH/2,P=!0),P&&(ot(a,t(a).textureViewX=T-g.width/d),ot(a,t(a).textureViewY=k-g.height/d)),o.useProgram(t(ke)),o.viewport(0,0,g.width,g.height),o.uniform2fv(t(et),[g.width,g.height]),!It){const Re=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,Re),o.bufferData(o.ARRAY_BUFFER,Rr,o.STATIC_DRAW),It={vbo:Re,step:8,attribs:ui}}te(o,It,6);const j=t(a).selectedTexture,R=(t(a).textureBoundX-t(a).textureViewX)*c,D=R+t(a).textureBoundW*c,y=(t(a).textureBoundY-t(a).textureViewY)*c,B=y+t(a).textureBoundH*c,$=G/j.width,E=F/j.width,A=S/j.height,V=I/j.height;o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.disable(o.DEPTH_TEST),o.useProgram(t(f)),o.uniform4fv(t(h),[j.width,j.height,g.width,g.height]),o.bindTexture(o.TEXTURE_2D,j.texture),o.uniform1i(t(v),u);const re=o.createBuffer();if(o.bindBuffer(o.ARRAY_BUFFER,re),o.bufferData(o.ARRAY_BUFFER,new Float32Array([R,y,$,A,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0,D,y,E,A,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0,R,B,$,V,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0,D,y,E,A,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0,D,B,E,V,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0,R,B,$,V,t(a).textureBoundX,t(a).textureBoundY,t(a).textureBoundW,t(a).textureBoundH,1,1,1,1,0,0,0]),o.STATIC_DRAW),te(o,{vbo:re,step:60,attribs:lr},6),o.deleteBuffer(re),t(Te)){const Re=t(ye)??0,Ae=R+(t(Ie)&&t(Fe)?t(Fe)*c:0),at=t(Ie)&&t(Se)?R+(t(Se)+1)*c:D,Ct=y+Re*c,ir=Math.max(y+(Re+1)*c,Ct+1),Kt=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,Kt),o.bufferData(o.ARRAY_BUFFER,new Float32Array([Ae,Ct,0,0,0,0,1,1,1,.15,.15,.4,1,0,0,at,Ct,1,0,0,0,1,1,1,.15,.15,.4,1,0,0,Ae,ir,0,1,0,0,1,1,1,.15,.15,.4,1,0,0,at,Ct,1,0,0,0,1,1,1,.15,.15,.4,1,0,0,at,ir,1,1,0,0,1,1,1,.15,.15,.4,1,0,0,Ae,ir,0,1,0,0,1,1,1,.15,.15,.4,1,0,0]),o.STATIC_DRAW),te(o,{vbo:Kt,step:60,attribs:lr},6),o.deleteBuffer(Kt)}return}nt&&(o.bindFramebuffer(o.DRAW_FRAMEBUFFER,nt),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)),o.disable(o.SCISSOR_TEST);for(let c of t(a).entities)if(c.enabled){if(c.type==="batch2d"){o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.disable(o.DEPTH_TEST);const d=t(a).textures[c.textureId];o.useProgram(t(f)),o.viewport(0,0,ge,Xe),o.uniform4fv(t(h),[d.width,d.height,c.targetWidth,c.targetHeight]),o.bindTexture(o.TEXTURE_2D,d.texture),o.uniform1i(t(v),u),te(o,c.buffer,c.vertexCount,c.enabledVerticesList)}if(c.type==="render3d"){o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.enable(o.DEPTH_TEST);const d=t(a).textures[c.textureId];o.useProgram(c.animated?t(L):t(s)),o.viewport(Ye,tt,se,Ve),o.uniformMatrix4fv(c.animated?t(q):t(_),!1,c.modelMatrix),o.uniformMatrix4fv(c.animated?t(fe):t(w),!1,xt),o.uniformMatrix4fv(c.animated?t(ce):t(l),!1,be),o.uniform2fv(c.animated?t(ie):t(p),[d.width,d.height]),o.bindTexture(o.TEXTURE_2D,d.texture),o.uniform1i(c.animated?t(H):t(b),u),te(o,c.buffer,c.vertexCount)}if(c.type==="renderparticles"){o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.enable(o.DEPTH_TEST);const d=t(a).textures[c.textureId];o.useProgram(t(W)),o.viewport(Ye,tt,se,Ve),o.uniformMatrix4fv(t(Q),!1,xt),o.uniformMatrix4fv(t(K),!1,be),o.uniform2fv(t(ve),[d.width,d.height]),o.bindTexture(o.TEXTURE_2D,d.texture),o.uniform1i(t(Z),u),te(o,c.buffer,c.vertexCount)}if(c.type==="icon"||c.type==="bigicon"){const d=c.texSize;o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.disable(o.DEPTH_TEST),o.useProgram(t(f)),o.viewport(0,0,ge,Xe),o.bindTexture(o.TEXTURE_2D,c.texture),o.uniform1i(t(v),u),o.uniform4fv(t(h),[d,d,c.targetWidth,c.targetHeight]),te(o,c.buffer,6)}if(c.type==="minimap2d"){!de||!nt?(de=o.createTexture(),o.bindTexture(o.TEXTURE_2D,de),o.texStorage2D(o.TEXTURE_2D,1,o.RGBA8,ze,je),nt=o.createFramebuffer(),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,nt),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,de,0)):o.bindFramebuffer(o.DRAW_FRAMEBUFFER,nt),o.viewport(0,0,ze,je),o.disable(o.DEPTH_TEST);const d=t(a).textures[c.textureId];o.useProgram(t(f)),o.uniform4fv(t(h),[d.width,d.height,ze,je]),o.bindTexture(o.TEXTURE_2D,d.texture),o.uniform1i(t(v),u),te(o,c.buffer,c.vertexCount,c.enabledVerticesList),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}if(c.type==="minimap"){if(de===null)continue;o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.disable(o.DEPTH_TEST),o.useProgram(t(f)),o.viewport(0,0,ge,Xe),o.uniform4fv(t(h),[ze,je,c.targetWidth,c.targetHeight]),o.bindTexture(o.TEXTURE_2D,de),o.uniform1i(t(v),u),te(o,c.buffer,6)}if(c.type=="billboard"){o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.enable(o.DEPTH_TEST),o.useProgram(t(Le)),o.viewport(Ye,tt,se,Ve);const d=t(a).textures[c.textureId];o.uniformMatrix4fv(t(jt),!1,c.modelMatrix),o.uniformMatrix4fv(t(qt),!1,xt),o.uniformMatrix4fv(t(Bt),!1,be),o.uniform2fv(t(Gt),[d.width,d.height]),o.bindTexture(o.TEXTURE_2D,d.texture),o.uniform1i(t(Ut),u),te(o,c.buffer,c.vertexCount,c.enabledVerticesList)}}},Mt=(g,o,c)=>{const d=new DataView(c),G=d.getUint32(0,!0);switch(G){case 0:{m(Be,!0),De(g,o);break}case 1:{const F=d.getUint32(4,!0),S=d.getUint32(8,!0),I=d.getUint32(12,!0),T=o.createTexture(),k=new Uint8Array(c,16,S*I*4);o.bindTexture(o.TEXTURE_2D,T),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,S,I,0,o.RGBA,o.UNSIGNED_BYTE,k),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),ot(a,t(a).textures[F]={texture:T,width:S,height:I,data:k});break}case 2:case 3:{const F=G===3,S=F?104:40,I=F?120:56,T=d.getUint32(4,!0),k=d.getUint32(8,!0),P=new Float32Array(16);P.set(new Float32Array(c,16,16));const j=new DataView(c,80,T*S),R=new Array(T),D=new ArrayBuffer(T*I),y=new DataView(D);for(let $=0;$<T;$+=1){const E=S*$,A=I*$;let V=null;F&&(V=new Float32Array(16),V.set(new Float32Array(c,80+S*$+40,16)));const re={x:j.getInt16(E,!0),y:j.getInt16(E+2,!0),z:j.getInt16(E+4,!0),u:j.getFloat32(E+8,!0),v:j.getFloat32(E+12,!0),ax:j.getUint16(E+16,!0),ay:j.getUint16(E+18,!0),aw:j.getUint16(E+20,!0),ah:j.getUint16(E+22,!0),r:j.getFloat32(E+24,!0),g:j.getFloat32(E+28,!0),b:j.getFloat32(E+32,!0),a:j.getFloat32(E+36,!0),anim:V};if(R[$]=re,y.setFloat32(A,re.x,!0),y.setFloat32(A+4,re.y,!0),y.setFloat32(A+8,re.z,!0),y.setFloat32(A+12,0,!0),y.setFloat32(A+16,re.u,!0),y.setFloat32(A+20,re.v,!0),y.setFloat32(A+24,re.ax,!0),y.setFloat32(A+28,re.ay,!0),y.setFloat32(A+32,re.aw,!0),y.setFloat32(A+36,re.ah,!0),y.setFloat32(A+40,re.r,!0),y.setFloat32(A+44,re.g,!0),y.setFloat32(A+48,re.b,!0),y.setFloat32(A+52,re.a,!0),V)for(let ae=0;ae<16;ae+=1)y.setFloat32(A+56+ae*4,V[ae],!0)}const B=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,B),o.bufferData(o.ARRAY_BUFFER,y,o.STATIC_DRAW),t(a).entities.push({type:"render3d",animated:F,textureId:k,vertexCount:T,modelMatrix:P,vertices:R,buffer:{vbo:B,step:I,attribs:F?ai:Yn},enabled:!0,expanded:!1,uuid:Zt()}),rt+=T,De(g,o);break}case 4:{const I=d.getUint32(4,!0),T=d.getUint32(8,!0),k=d.getUint16(12,!0),P=d.getUint16(14,!0),j=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,j);const R=new DataView(c,16,I*40),D=new ArrayBuffer(I*60),y=new DataView(D),B=new Array(I);for(let $=0;$<I;$+=1){const E=40*$,A=60*$,V={x:R.getInt16(E,!0),y:R.getInt16(E+2,!0),ax:R.getInt16(E+4,!0),ay:R.getInt16(E+6,!0),aw:R.getInt16(E+8,!0),ah:R.getInt16(E+10,!0),discard:R.getUint8(E+12),wrapx:R.getUint8(E+13),wrapy:R.getUint8(E+14),u:R.getFloat32(E+16,!0),v:R.getFloat32(E+20,!0),r:R.getFloat32(E+24,!0),g:R.getFloat32(E+28,!0),b:R.getFloat32(E+32,!0),a:R.getFloat32(E+36,!0)};B[$]=V,y.setFloat32(A,V.x,!0),y.setFloat32(A+4,V.y,!0),y.setFloat32(A+8,V.u,!0),y.setFloat32(A+12,V.v,!0),y.setFloat32(A+16,V.ax,!0),y.setFloat32(A+20,V.ay,!0),y.setFloat32(A+24,V.aw,!0),y.setFloat32(A+28,V.ah,!0),y.setFloat32(A+32,V.r,!0),y.setFloat32(A+36,V.g,!0),y.setFloat32(A+40,V.b,!0),y.setFloat32(A+44,V.a,!0),y.setFloat32(A+48,V.discard,!0),y.setFloat32(A+52,V.wrapx,!0),y.setFloat32(A+56,V.wrapy,!0)}o.bufferData(o.ARRAY_BUFFER,y,o.STATIC_DRAW),t(a).entities.push({type:"batch2d",textureId:T,vertexCount:I,vertices:B,targetWidth:k,targetHeight:P,buffer:{vbo:j,step:60,attribs:lr},enabled:!0,expanded:!1,uuid:Zt(),enabledVerticesList:Array(Math.floor(I)).fill(!0)}),rt+=I,De(g,o);break}case 5:case 8:{const S=G===5?64:512,I=d.getInt16(4,!0),T=d.getInt16(6,!0),k=d.getInt16(8,!0),P=d.getInt16(10,!0),j=d.getUint32(12,!0),R=d.getFloat32(16,!0),D=d.getFloat32(20,!0),y=d.getFloat32(24,!0),B=d.getFloat32(28,!0),$=d.getUint16(32,!0),E=d.getUint16(34,!0),A=o.createTexture(),V=o.createFramebuffer();o.bindTexture(o.TEXTURE_2D,A),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,V),o.texStorage2D(o.TEXTURE_2D,1,o.RGBA8,S,S),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,A,0),o.enable(o.CULL_FACE),o.cullFace(o.FRONT),o.viewport(0,0,S,S),o.scissor(0,0,S,S);let re=Array(j),ae=36;for(let Kt=0;Kt<j;Kt+=1){const gr=d.getUint32(ae,!0);let Un=Array(gr);const Sa=new ArrayBuffer(gr*56),st=new DataView(Sa),tn=new Float32Array(16);tn.set(new Float32Array(c,ae+4,16));const rn=new Float32Array(16);rn.set(new Float32Array(c,ae+68,16));const nn=new Float32Array(16);nn.set(new Float32Array(c,ae+132,16)),ae+=196;for(let Dr=0;Dr<gr;Dr+=1){const Lt={x:d.getInt16(ae,!0),y:d.getInt16(ae+2,!0),z:d.getInt16(ae+4,!0),r:d.getFloat32(ae+8,!0),g:d.getFloat32(ae+12,!0),b:d.getFloat32(ae+16,!0),a:d.getFloat32(ae+20,!0)},dt=Dr*56;st.setFloat32(dt,Lt.x,!0),st.setFloat32(dt+4,Lt.y,!0),st.setFloat32(dt+8,Lt.z,!0),st.setFloat32(dt+24,0,!0),st.setFloat32(dt+28,0,!0),st.setFloat32(dt+32,S,!0),st.setFloat32(dt+36,S,!0),st.setFloat32(dt+40,Lt.r,!0),st.setFloat32(dt+44,Lt.g,!0),st.setFloat32(dt+48,Lt.b,!0),st.setFloat32(dt+52,Lt.a,!0),Un[Dr]=Lt,ae+=24}re[Kt]={vertices:Un,modelMatrix:tn,viewMatrix:rn,projMatrix:nn};const an=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,an),o.bufferData(o.ARRAY_BUFFER,st,o.STATIC_DRAW),o.useProgram(t(s)),o.uniformMatrix4fv(t(_),!1,tn),o.uniformMatrix4fv(t(w),!1,rn),o.uniformMatrix4fv(t(l),!1,nn),o.uniform2fv(t(p),[1,1]),o.bindTexture(o.TEXTURE_2D,t(z)),o.uniform1i(t(b),u),te(o,{vbo:an,attribs:Yn,step:56},gr),o.deleteBuffer(an)}const Re=I,Ae=I+k,at=T,Ct=T+P,ir=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,ir),o.bufferData(o.ARRAY_BUFFER,new Float32Array([Re,at,0,1,0,0,S,S,R,y,D,B,0,0,0,Ae,at,1,1,0,0,S,S,R,y,D,B,0,0,0,Re,Ct,0,0,0,0,S,S,R,y,D,B,0,0,0,Ae,at,1,1,0,0,S,S,R,y,D,B,0,0,0,Ae,Ct,1,0,0,0,S,S,R,y,D,B,0,0,0,Re,Ct,0,0,0,0,S,S,R,y,D,B,0,0,0]),o.STATIC_DRAW),t(a).entities.push({type:G===5?"icon":"bigicon",models:re,texture:A,targetWidth:$,targetHeight:E,texSize:S,buffer:{vbo:ir,step:60,attribs:lr},targetx:I,targety:T,targetw:k,targeth:P,enabled:!0,expanded:!1,uuid:Zt()}),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.deleteFramebuffer(V),o.disable(o.CULL_FACE);break}case 6:{const F=d.getUint32(4,!0),S=d.getUint32(8,!0);ze=d.getUint16(12,!0),je=d.getUint16(14,!0);const I=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,I);const T=new DataView(c,16,F*40),k=new ArrayBuffer(F*60),P=new DataView(k),j=new Array(F);for(let R=0;R<F;R+=1){const D=40*R,y=60*R,B={x:T.getInt16(D,!0),y:T.getInt16(D+2,!0),ax:T.getInt16(D+4,!0),ay:T.getInt16(D+6,!0),aw:T.getInt16(D+8,!0),ah:T.getInt16(D+10,!0),discard:T.getUint8(D+12),wrapx:T.getUint8(D+13),wrapy:T.getUint8(D+14),u:T.getFloat32(D+16,!0),v:T.getFloat32(D+20,!0),r:T.getFloat32(D+24,!0),g:T.getFloat32(D+28,!0),b:T.getFloat32(D+32,!0),a:T.getFloat32(D+36,!0)};j[R]=B,P.setFloat32(y,B.x,!0),P.setFloat32(y+4,B.y,!0),P.setFloat32(y+8,B.u,!0),P.setFloat32(y+12,B.v,!0),P.setFloat32(y+16,B.ax,!0),P.setFloat32(y+20,B.ay,!0),P.setFloat32(y+24,B.aw,!0),P.setFloat32(y+28,B.ah,!0),P.setFloat32(y+32,B.r,!0),P.setFloat32(y+36,B.g,!0),P.setFloat32(y+40,B.b,!0),P.setFloat32(y+44,B.a,!0),P.setFloat32(y+48,B.discard,!0),P.setFloat32(y+52,B.wrapx,!0),P.setFloat32(y+56,B.wrapy,!0)}o.bufferData(o.ARRAY_BUFFER,P,o.STATIC_DRAW),t(a).entities.push({type:"minimap2d",textureId:S,buffer:{vbo:I,attribs:lr,step:60},vertices:j,vertexCount:F,enabled:!0,expanded:!1,enabledVerticesList:Array(Math.floor(F)).fill(!0),uuid:Zt()}),rt+=F,De(g,o);break}case 7:{const F=d.getInt16(4,!0),S=d.getInt16(6,!0),I=d.getUint16(8,!0),T=d.getUint16(10,!0),k=d.getInt16(12,!0),P=d.getInt16(14,!0),j=d.getUint16(16,!0),R=d.getUint16(18,!0),D=d.getUint16(20,!0),y=d.getUint16(22,!0),B=k,$=k+j,E=P,A=P+R,V=F/ze,re=(F+I)/ze,ae=S/je,Re=(S+T)/je,Ae=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,Ae),o.bufferData(o.ARRAY_BUFFER,new Float32Array([B,E,V,Re,F,S,I,T,1,1,1,1,0,0,0,$,E,re,Re,F,S,I,T,1,1,1,1,0,0,0,B,A,V,ae,F,S,I,T,1,1,1,1,0,0,0,$,E,re,Re,F,S,I,T,1,1,1,1,0,0,0,$,A,re,ae,F,S,I,T,1,1,1,1,0,0,0,B,A,V,ae,F,S,I,T,1,1,1,1,0,0,0]),o.STATIC_DRAW),t(a).entities.push({type:"minimap",sourcex:F,sourcey:S,sourcew:I,sourceh:T,targetx:k,targety:P,targetw:j,targeth:R,targetWidth:D,targetHeight:y,buffer:{vbo:Ae,step:60,attribs:lr},enabled:!0,expanded:!1,uuid:Zt()}),De(g,o);break}case 9:{const F=d.getUint32(4,!0),S=d.getUint32(8,!0),I=64,T=72,k=new DataView(c,16,F*I),P=new Array(F),j=new ArrayBuffer(F*T),R=new DataView(j);for(let y=0;y<F;y+=1){const B=I*y,$=T*y,E={x:k.getFloat32(B,!0),y:k.getFloat32(B+4,!0),z:k.getFloat32(B+8,!0),offsetx2d:k.getFloat32(B+12,!0),offsety2d:k.getFloat32(B+16,!0),offsetx3d:k.getFloat32(B+20,!0),offsety3d:k.getFloat32(B+24,!0),offsetz3d:k.getFloat32(B+28,!0),ax:k.getUint16(B+32,!0),ay:k.getUint16(B+34,!0),aw:k.getUint16(B+36,!0),ah:k.getUint16(B+38,!0),r:k.getFloat32(B+40,!0),g:k.getFloat32(B+44,!0),b:k.getFloat32(B+48,!0),a:k.getFloat32(B+52,!0),u:k.getFloat32(B+56,!0),v:k.getFloat32(B+60,!0)};P[y]=E,R.setFloat32($,E.x,!0),R.setFloat32($+4,E.y,!0),R.setFloat32($+8,E.z,!0),R.setFloat32($+12,E.ax,!0),R.setFloat32($+16,E.ay,!0),R.setFloat32($+20,E.aw,!0),R.setFloat32($+24,E.ah,!0),R.setFloat32($+28,E.r,!0),R.setFloat32($+32,E.g,!0),R.setFloat32($+36,E.b,!0),R.setFloat32($+40,E.a,!0),R.setFloat32($+44,E.offsetx2d,!0),R.setFloat32($+48,E.offsety2d,!0),R.setFloat32($+52,E.offsetx3d,!0),R.setFloat32($+56,E.offsety3d,!0),R.setFloat32($+60,E.offsetz3d,!0),R.setFloat32($+64,E.u,!0),R.setFloat32($+68,E.v,!0)}const D=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,D),o.bufferData(o.ARRAY_BUFFER,R,o.STATIC_DRAW),t(a).entities.push({type:"renderparticles",textureId:S,vertexCount:F,vertices:P,buffer:{vbo:D,step:T,attribs:oi},enabled:!0,expanded:!1,uuid:Zt()}),rt+=F,De(g,o);break}case 10:{xt=new Float32Array(c,4,16),be=new Float32Array(c,68,16);break}case 11:{const I=d.getUint32(4,!0),T=d.getUint32(8,!0),k=new Float32Array(16);k.set(new Float32Array(c,16,16));const P=new DataView(c,80,I*48),j=new Array(I),R=new ArrayBuffer(I*64),D=new DataView(R);for(let B=0;B<I;B+=1){const $=48*B,E=64*B,A={x:P.getInt16($,!0),y:P.getInt16($+2,!0),z:P.getInt16($+4,!0),offsetx:P.getFloat32($+8,!0),offsety:P.getFloat32($+12,!0),u:P.getFloat32($+16,!0),v:P.getFloat32($+20,!0),ax:P.getUint16($+24,!0),ay:P.getUint16($+26,!0),aw:P.getUint16($+28,!0),ah:P.getUint16($+30,!0),r:P.getFloat32($+32,!0),g:P.getFloat32($+36,!0),b:P.getFloat32($+40,!0),a:P.getFloat32($+44,!0)};j[B]=A,D.setFloat32(E,A.x,!0),D.setFloat32(E+4,A.y,!0),D.setFloat32(E+8,A.z,!0),D.setFloat32(E+12,0,!0),D.setFloat32(E+16,A.u,!0),D.setFloat32(E+20,A.v,!0),D.setFloat32(E+24,A.ax,!0),D.setFloat32(E+28,A.ay,!0),D.setFloat32(E+32,A.aw,!0),D.setFloat32(E+36,A.ah,!0),D.setFloat32(E+40,A.r,!0),D.setFloat32(E+44,A.g,!0),D.setFloat32(E+48,A.b,!0),D.setFloat32(E+52,A.a,!0),D.setFloat32(E+56,A.offsetx,!0),D.setFloat32(E+60,A.offsety,!0)}const y=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,y),o.bufferData(o.ARRAY_BUFFER,D,o.STATIC_DRAW),t(a).entities.push({type:"billboard",textureId:T,vertexCount:I,modelMatrix:k,vertices:j,buffer:{vbo:y,step:64,attribs:ii},enabled:!0,expanded:!1,uuid:Zt(),enabledVerticesList:Array(Math.floor(I)).fill(!0)}),rt+=I,De(g,o);break}}};window.addEventListener("message",async g=>{if(typeof g.data=="object"&&g.data.type==="pluginMessage"){if(typeof g.data.content!="object"||!t(le)||!t(x))return;Mt(t(le),t(x),g.data.content)}});const $t=g=>Array.from(g).map(o=>{const c=o.toString(16);return c.length===1?"\\x0".concat(c):"\\x".concat(c)}).join(""),ct=()=>{const g=t(a).selectedTexture;if(!g){m(Ce,"error: no texture selected");return}const o=t(a).textureBoundW*4,c=new Array(t(a).textureBoundH);for(let d=0;d<t(a).textureBoundH;d+=1){const G=(t(a).textureBoundY+d)*g.width*4+t(a).textureBoundX*4,F=g.data.slice(G,G+o),S=$t(F);c[d]=`  [${d+1}] = '${S}',`}m(Ce,`local data = {
${c.join(`
`)}
}`)},Pt=g=>{const o=t(a).textureViewScale/100,c=Math.floor(t(a).textureViewX+g.offsetX/o-t(a).textureBoundX),d=Math.floor(t(a).textureViewY+g.offsetY/o-t(a).textureBoundY);if(c<0||d<0||c>=t(a).textureBoundW||d>=t(a).textureBoundH){m(qe,null);return}m(qe,{x:c,y:d})},ht=g=>{if(Pt(g),!(g.buttons&1)){m(Ge,Pt);return}const o=t(a).textureViewScale/100;ot(a,t(a).textureViewX-=g.movementX/o),ot(a,t(a).textureViewY-=g.movementY/o),t(a).redraw()},Me=g=>{const o=t(le),c=t(a).textureViewScale,d=t(a).textureViewScale-Jr*Math.sign(g.deltaY);ot(a,t(a).textureViewScale=d);const G=2*c/100,F=2*d/100,S=t(a).textureViewX+o.width/G,I=t(a).textureViewY+o.height/G;ot(a,t(a).textureViewX=S-o.width/F),ot(a,t(a).textureViewY=I-o.height/F),De(o,t(x))};let Ge=M(Pt);on(()=>(t(ye),t(Ie),t(Fe),t(Se)),()=>{m(r,t(ye)===null||t(Ie)&&(t(Fe)===null||t(Se)===null||t(Fe)>t(Se)))}),on(()=>(t(le),t(x),t(z),t(f),t(s),t(L),t(W),t(ke),t(Le)),()=>{if(t(le)&&(ot(le,t(le).width=ge),ot(le,t(le).height=Xe),m(x,t(le).getContext("webgl2")),t(x))){m(Dt,t(x).getParameter(t(x).MAX_VERTEX_ATTRIBS)),m(z,t(x).createTexture()),t(x).bindTexture(t(x).TEXTURE_2D,t(z));const g=new Uint8Array([255,255,255,255]);t(x).texImage2D(t(x).TEXTURE_2D,0,t(x).RGBA,1,1,0,t(x).RGBA,t(x).UNSIGNED_BYTE,g);const o=yt(t(x),t(x).VERTEX_SHADER,Go,"2D vertex shader"),c=yt(t(x),t(x).FRAGMENT_SHADER,Ko,"2D fragment shader"),d=yt(t(x),t(x).VERTEX_SHADER,Zo,"3D vertex shader"),G=yt(t(x),t(x).VERTEX_SHADER,Qo,"3D anim vertex shader"),F=yt(t(x),t(x).FRAGMENT_SHADER,Jo,"3D fragment shader"),S=yt(t(x),t(x).VERTEX_SHADER,ei,"particle vertex shader"),I=yt(t(x),t(x).VERTEX_SHADER,ti,"checkers vertex shader"),T=yt(t(x),t(x).FRAGMENT_SHADER,ri,"checkers fragment shader"),k=yt(t(x),t(x).VERTEX_SHADER,ni,"billboard vertex shader");m(f,fr(t(x),o,c,"2D program")),m(h,t(x).getUniformLocation(t(f),"atlas_wh_screen_wh")),m(v,t(x).getUniformLocation(t(f),"tex")),m(s,fr(t(x),d,F,"3D program")),m(_,t(x).getUniformLocation(t(s),"modelmatrix")),m(w,t(x).getUniformLocation(t(s),"viewmatrix")),m(l,t(x).getUniformLocation(t(s),"projmatrix")),m(p,t(x).getUniformLocation(t(s),"atlas_wh")),m(b,t(x).getUniformLocation(t(s),"tex")),m(L,fr(t(x),G,F,"3D animated program")),m(q,t(x).getUniformLocation(t(L),"modelmatrix")),m(fe,t(x).getUniformLocation(t(L),"viewmatrix")),m(ce,t(x).getUniformLocation(t(L),"projmatrix")),m(ie,t(x).getUniformLocation(t(L),"atlas_wh")),m(H,t(x).getUniformLocation(t(L),"tex")),m(W,fr(t(x),S,F,"Particles program")),m(Q,t(x).getUniformLocation(t(W),"viewmatrix")),m(K,t(x).getUniformLocation(t(W),"projmatrix")),m(Z,t(x).getUniformLocation(t(W),"tex")),m(ve,t(x).getUniformLocation(t(W),"atlas_wh")),m(ke,fr(t(x),I,T,"Checkers program")),m(et,t(x).getUniformLocation(t(ke),"screen_wh")),m(Le,fr(t(x),k,F,"Billboard program")),m(jt,t(x).getUniformLocation(t(Le),"modelmatrix")),m(qt,t(x).getUniformLocation(t(Le),"viewmatrix")),m(Bt,t(x).getUniformLocation(t(Le),"projmatrix")),m(Gt,t(x).getUniformLocation(t(Le),"atlas_wh")),m(Ut,t(x).getUniformLocation(t(Le),"tex")),t(x).deleteShader(o),t(x).deleteShader(c),t(x).deleteShader(d),t(x).deleteShader(F),t(x).deleteShader(G),t(x).deleteShader(S),t(x).deleteShader(I),t(x).deleteShader(T),t(x).deleteShader(k),t(x).activeTexture(t(x).TEXTURE0+u),t(x).enable(t(x).SCISSOR_TEST),t(x).disable(t(x).CULL_FACE),t(x).disable(t(x).DEPTH_TEST),t(x).enable(t(x).BLEND),t(x).blendEquationSeparate(t(x).FUNC_ADD,t(x).FUNC_ADD),t(x).depthFunc(t(x).LEQUAL),De(t(le),t(x))}}),on(()=>(t(Te),t(xe),t(we),t(_e),t(Ee),t(r),t(le),t(x)),()=>{const g=t(Te);m(Te,(t(xe)||t(we)||t(_e)||t(Ee))&&!t(r)),t(le)&&t(x)&&t(Te)!==g&&De(t(le),t(x))}),co(),nr();var ar=Au(),pt=oe(ar);pt.__mousedown=[vu,Ge,ht],pt.__mouseup=[_u,Ge,Pt],pt.__mousemove=function(...g){var o;(o=t(Ge))==null||o.apply(this,g)},Fa(pt,g=>m(le,g),()=>t(le));var or=C(pt,2);{var hr=g=>{var o=hu(),c=oe(o),d=he(c);ru(d,{get data(){return t(a)},set data(F){m(a,F)},$$legacy:!0});var G=C(c,2);G.__click=[xu,Ue],N(g,o)},pr=(g,o)=>{{var c=d=>{var G=gu();G.__click=[pu,Ue],N(d,G)};ee(g,d=>{t(Be)&&d(c)},o)}};ee(or,g=>{t(Ue)?g(hr):g(pr,!1)})}var Ke=C(or,2);{var Ir=g=>{var o=Eu(),c=oe(o);{var d=A=>{var V=mu();V.__click=[wu,a,De,le,x],N(A,V)};ee(c,A=>{t(Ce)===null&&A(d)})}var G=C(c,2),F=he(G),S=he(F),I=he(S),T=C(I,2),k=C(S,2),P=he(k),j=C(P,2),R=C(k,2),D=C(he(R));D.__change=function(...A){var V;(V=t(a).redraw)==null||V.apply(this,A)};var y=C(D,2);y.__click=[du,a,Ce,ye,Ie,Fe,Se,$t];var B=C(y,4);{var $=A=>{var V=bu(),re=oe(V),ae=C(re,2);ae.__change=function(...Ae){var at;(at=t(a).redraw)==null||at.apply(this,Ae)};var Re=C(ae,2);Re.__change=function(...Ae){var at;(at=t(a).redraw)==null||at.apply(this,Ae)},Aa(re,()=>t(Ie),Ae=>m(Ie,Ae)),Oe("focus",ae,()=>m(_e,!0)),Oe("blur",ae,()=>m(_e,!1)),Cr(ae,()=>t(Fe),Ae=>m(Fe,Ae)),Oe("focus",Re,()=>m(Ee,!0)),Oe("blur",Re,()=>m(Ee,!1)),Cr(Re,()=>t(Se),Ae=>m(Se,Ae)),N(A,V)},E=A=>{var V=yu(),re=C(oe(V));re.__click=ct,N(A,V)};ee(B,A=>{t(a).viewIsWholeAtlas?A($):A(E,!1)})}ut(()=>{var A,V;me(I,`x: ${((A=t(qe))==null?void 0:A.x)??""} `),me(T,` y: ${((V=t(qe))==null?void 0:V.y)??""}`),me(P,`${t(a).textureBoundW??""}x${t(a).textureBoundH??""} `),me(j,` zoom: ${t(a).textureViewScale??""}%`),y.disabled=t(r)}),Oe("mouseenter",R,()=>m(xe,!0)),Oe("mouseleave",R,()=>m(xe,!1)),Oe("focus",D,()=>m(we,!0)),Oe("blur",D,()=>m(we,!1)),Cr(D,()=>t(ye),A=>m(ye,A)),N(g,o)};ee(Ke,g=>{t(a).selectedTexture&&g(Ir)})}var en=C(Ke,2);{var kt=g=>{cu(g,{get text(){return t(Ce)},set text(o){m(Ce,o)},$$legacy:!0})};ee(en,g=>{t(Ce)!==null&&g(kt)})}Oe("wheel",pt,Me),N(e,ar),zt()}rr(["mousedown","mouseup","mousemove","click","change"]);Mo(Fu,{target:document.body});
